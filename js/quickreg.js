function bindRegByPhone(){$("button[name=btn-reg]").on("click",function(e){var n=$("input[name=activeCode]").val();if(null==n||""==n)return void alert("请先获取验证码");if(isEmpty(sessionid))return void alert("请先滑动验证");var t=$("#phone").intlTelInput("getSelectedCountryData"),a=t.dialCode,i=$("#phone").intlTelInput("getNumber").replace("+"+a,""),o=t.iso2,r=$("input[name=tracking]").val();console.log(t);var s={activeCode:n,mobilePhoneAreaCode:a,mobilePhoneNumber:i,nationality:o,tracking:r};console.log(JSON.stringify(s)),$.ajax({url:QUICK_REGISTER_URL_PHONE,method:"POST",data:JSON.stringify(s),headers:{captcha:"sessionid="+sessionid+";sig="+sig+";token="+nc_token+";scene=nc_register_h5"},contentType:"application/json"}).done(function(e,n,t){e.success?window.location.href=QUICK_REGISTER_SUCCESS+"?flag=success&code="+e.data.result:alert(e.message)}).fail(function(e,n,t){$(".alert").html(e.responseText),$(".alert").removeClass("hidden")})})}function clickSendValid(){var e=$("#phone");if($.trim(e.val())){if(!e.intlTelInput("isValidNumber"))return e.addClass("error"),void alert("手机号格式不对");if(isEmpty(this.sessionid))return void alert("请先滑动验证");var n=$("#phone").intlTelInput("getSelectedCountryData"),t=n.dialCode,a=e.val(),i={phoneNum:a,areaCode:t},o=sendSms({url:QUICK_REGISTER_PHONE,pram:i});if(o.success){$(".send_code_group").show(),$(".nc-container").hide(),$(".active_code").show();var r=$("#sendCode"),s=r.text();countDown({el:r,duration:60,cb:function(){r.text(s),r.removeAttr("disabled"),r.toggleClass("count_down")}})}else alert(o.message),nc.reset()}}function sendSms(e){var n=e.pram;n.lanKey=n.langKey;var t;return $.ajax({url:e.url,method:"GET",data:n,async:!1,headers:{captcha:"sessionid="+sessionid+";sig="+sig+";token="+nc_token+";scene=nc_register_h5"},contentType:"application/json"}).done(function(e,n,a){t=e}).fail(function(e,n,t){$(".alert").html(e.responseText),$(".alert").removeClass("hidden")}),t}function getParam(e){if(paramValue="",isFound=!1,0==this.location.search.indexOf("?")&&this.location.search.indexOf("=")>1)for(arrSource=unescape(this.location.search).substring(1,this.location.search.length).split("&"),i=0;i<arrSource.length&&!isFound;)arrSource[i].indexOf("=")>0&&arrSource[i].split("=")[0].toLowerCase()==e.toLowerCase()&&(paramValue=arrSource[i].split("=")[1],isFound=!0),i++;return""==paramValue&&(paramValue=null),paramValue}function countDown(e){e.el.attr("disabled","true"),e.el.toggleClass("count_down"),console.log(e);var n=e.duration,t=e.el;setTimeout(function(){clearInterval(a),e.cb&&e.cb()},1e3*n),n--,t.text(n+" s ");var a=setInterval(function(){n--,console.log(n),t.text(n+" s ")},1e3)}function isEmpty(e){return void 0===e||null==e||""==e}var sessionid,nc_token,sig;$(document).ready(function(){var e=getParam("i");$("input[name=tracking]").val(e),$("#phone").attr("placeholder","请输入手机号"),bindRegByPhone(),$("#recipient-name").bind("input propertychange",function(){isEmpty($("#recipient-name").val())?$("button[name=btn-reg]").attr("disabled","true"):$("button[name=btn-reg]").removeAttr("disabled")}),$(".send_code_group").hide()});var nc,nc_token;$(function(){nc_token=["FFFF00000000017B2097",(new Date).getTime(),Math.random()].join(":"),nc=NoCaptcha.init({renderTo:"#nc",appkey:"FFFF00000000017B2097",scene:"nc_register_h5",token:nc_token,trans:{key1:"code200"},elementID:["usernameID"],is_Opt:0,language:"cn",timeout:1e4,retryTimes:5,errorTimes:5,inline:!1,apimap:{},bannerHidden:!1,initHidden:!1,callback:function(e){window.sessionid=e.csessionid,window.sig=e.sig,clickSendValid()},error:function(e){}}),NoCaptcha.setEnabled(!0),nc.reset(),NoCaptcha.upLang("cn",{LOADING:"加载中...",SLIDER_LABEL:"向右滑动获取验证码",CHECK_Y:"验证通过",ERROR_TITLE:"非常抱歉，这出错了...",CHECK_N:"验证未通过",OVERLAY_INFORM:"经检测你当前操作环境存在风险，请输入验证码",TIPS_TITLE:"验证码错误，请重新输入"})});