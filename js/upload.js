function send_request(e){var t=null;if(window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),null!=t){var i=e||GOT_OSS;return t.open("GET",i,!1),t.setRequestHeader("Authorization","Bearer "+token),t.send(null),t.responseText}alert("Your browser does not support XMLHTTP.")}function check_object_radio(){for(var e=document.getElementsByName("myradio"),t=0;t<e.length;t++)if(e[t].checked){g_object_name_type=e[t].value;break}}function get_signature(){var now=timestamp=Date.parse(new Date)/1e3;if(expire<now+3){var body=send_request(),obj=eval("("+body+")").data;return host=obj.host,policyBase64=obj.policy,accessid=obj.accessid,signature=obj.signature,expire=parseInt(obj.expire),callbackbody=obj.callback,key=obj.dir,!0}return!1}function random_string(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",i=t.length,s="",a=0;a<e;a++)s+=t.charAt(Math.floor(Math.random()*i));return s}function get_suffix(e){var t=e.lastIndexOf("."),i="";return-1!=t&&(i=e.substring(t)),i}function calculate_object_name(e){if("local_name"==g_object_name_type)g_object_name+="${filename}";else if("random_name"==g_object_name_type){var t=get_suffix(e);g_object_name=key+random_string(10)+t}return""}function get_uploaded_object_name(e){if("local_name"==g_object_name_type){var t=g_object_name;return t=t.replace("${filename}",e)}if("random_name"==g_object_name_type)return g_object_name}function set_upload_param(e,t,i){if(0==i&&(i=get_signature()),g_object_name=key,""!=t){get_suffix(t);calculate_object_name(t)}var s={key:finalFile+g_object_name,policy:policyBase64,OSSAccessKeyId:accessid,success_action_status:"200",callback:callbackbody,signature:signature};e.setOption({url:host,multipart_params:s}),e.start()}var accessid="",accesskey="",host="",policyBase64="",signature="",callbackbody="",filename="",key="",expire=0,g_object_name="",g_object_name_type="random_name",timestamp,now=timestamp=Date.parse(new Date)/1e3,token=getToken();$(function(){if(!token)return void(location.href=LOGIN_PAGE+"?redirect="+location.href);uploader0.init(),uploader1.init(),uploader2.init()});var finalDir1=token.substring(0,2).toLowerCase(),finalDir2=token.substring(2,4).toLowerCase(),finalFile=finalDir1+"/"+finalDir2+"/",uploader0=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"frontImage",container:document.getElementById("frontImageContainer"),el:$("#frontImageContainer"),flash_swf_url:"lib/plupload/js/Moxie.swf",silverlight_xap_url:"lib/plupload/js/Moxie.xap",url:"http://oss.aliyuncs.com",filters:{mime_types:[{title:"Image files",extensions:"jpg,gif,png,bmp,jpeg"},{title:"Zip files",extensions:"zip,rar"}],max_file_size:"10mb",prevent_duplicates:!0},init:{PostInit:function(){},FilesAdded:function(e,t){this.settings.el.attr("isUpload","0"),this.settings.el.siblings(".with-errors").text(""),set_upload_param(uploader0,finalFile,!1)},BeforeUpload:function(e,t){set_upload_param(e,t.name,!0)},UploadProgress:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded "+t.percent+"%, please wait...")},FileUploaded:function(e,t,i){if(200===i.status){this.settings.el.siblings(".with-errors").text("");var s=get_uploaded_object_name(t.name),a=host+"/"+finalFile+s;this.settings.el.attr("imgUrl",a),this.settings.el.attr("isUpload","1"),this.settings.el.find(".upload-image").css({"background-image":"url("+a+"?x-oss-process=image/resize,m_lfit,h_750,w_450)"})}else this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")},Error:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")}}}),uploader1=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"backImage",container:document.getElementById("backImageContainer"),el:$("#backImageContainer"),flash_swf_url:"lib/plupload/js/Moxie.swf",silverlight_xap_url:"lib/plupload/js/Moxie.xap",url:"http://oss.aliyuncs.com",filters:{mime_types:[{title:"Image files",extensions:"jpg,gif,png,bmp,jpeg"},{title:"Zip files",extensions:"zip,rar"}],max_file_size:"10mb",prevent_duplicates:!0},init:{PostInit:function(){},FilesAdded:function(e,t){this.settings.el.attr("isUpload","0"),this.settings.el.siblings(".with-errors").text(""),set_upload_param(uploader1,finalFile,!1)},BeforeUpload:function(e,t){set_upload_param(e,t.name,!0)},UploadProgress:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded "+t.percent+"%, please wait...")},FileUploaded:function(e,t,i){if(200===i.status){this.settings.el.siblings(".with-errors").text("");var s=get_uploaded_object_name(t.name),a=host+"/"+finalFile+s;this.settings.el.attr("imgUrl",a),this.settings.el.attr("isUpload","1"),this.settings.el.find(".upload-image").css({"background-image":"url("+a+"?x-oss-process=image/resize,m_lfit,h_750,w_450)"})}else this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")},Error:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")}}}),uploader2=new plupload.Uploader({runtimes:"html5,flash,silverlight,html4",browse_button:"holdImage",container:document.getElementById("holdImageContainer"),el:$("#holdImageContainer"),flash_swf_url:"lib/plupload/js/Moxie.swf",silverlight_xap_url:"lib/plupload/js/Moxie.xap",url:"http://oss.aliyuncs.com",filters:{mime_types:[{title:"Image files",extensions:"jpg,gif,png,bmp,jpeg"},{title:"Zip files",extensions:"zip,rar"}],max_file_size:"10mb",prevent_duplicates:!0},init:{PostInit:function(){},FilesAdded:function(e,t){this.settings.el.attr("isUpload","0"),this.settings.el.siblings(".with-errors").text(""),set_upload_param(uploader2,finalFile,!1)},BeforeUpload:function(e,t){set_upload_param(e,t.name,!0)},UploadProgress:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded "+t.percent+"%, please wait...")},FileUploaded:function(e,t,i){if(200===i.status){this.settings.el.siblings(".with-errors").text("");var s=get_uploaded_object_name(t.name),a=host+"/"+finalFile+s;this.settings.el.attr("imgUrl",a),this.settings.el.attr("isUpload","1"),this.settings.el.find(".upload-image").css({"background-image":"url("+a+"?x-oss-process=image/resize,m_lfit,h_750,w_450)"})}else this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")},Error:function(e,t){this.settings.el.siblings(".with-errors").text("uploaded error, please try again!")}}});