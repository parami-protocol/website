function bindRegByPhone(){$("button[name=btn-reg]").on("click",function(e){var t=$("input[name=activeCode]").val();if(null==t||""==t)return void alert("请先获取验证码");var n=$("#phone").intlTelInput("getSelectedCountryData"),a=n.dialCode,o=$("#phone").intlTelInput("getNumber").replace("+"+a,""),r=n.iso2,i=$("input[name=tracking]").val();console.log(n);var l={activeCode:t,mobilePhoneAreaCode:a,mobilePhoneNumber:o,nationality:r,tracking:i,regSource:"IIC"};console.log(JSON.stringify(l)),$.ajax({url:QUICK_REGISTER_URL_PHONE,method:"POST",data:JSON.stringify(l),contentType:"application/json"}).done(function(e,t,n){e.success?window.location.href=IIC_QUICK_REGISTER_SUCCESS+"?flag=success&code="+e.data.result:alert(e.message)}).fail(function(e,t,n){$(".alert").html(e.responseText),$(".alert").removeClass("hidden")})})}function clickSendValid(){var e=$("#phone");if($.trim(e.val())){if(!e.intlTelInput("isValidNumber"))return e.addClass("error"),void alert("手机号格式不对");var t=$("#phone").intlTelInput("getSelectedCountryData"),n=t.dialCode,a=e.val(),o={phoneNum:a,areaCode:n,regSource:"IIC"},r=sendSms({url:REGISTER_PHONE,pram:o});if(r.success){$(".active_code").show();var i=$("#sendCode"),l=i.text();countDown({el:i,duration:60,cb:function(){i.text(l),i.removeAttr("disabled"),i.toggleClass("count_down")}})}else alert(r.message),10104!=r.msgCode&&10113!=r.msgCode||("https://chain.pro/tpl/iic/reg.html?source=wechat"===window.location.href?window.location.href=IIC_LOGIN+"?source=wechat":window.location.href=IIC_LOGIN)}}function sendSms(e){var t=e.pram;t.lanKey=t.langKey;var n;return $.ajax({url:e.url,method:"GET",data:t,async:!1,contentType:"application/json"}).done(function(e,t,a){n=e}).fail(function(e,t,n){403==e.status&&alert("访问频次过高,锁定半小时,请稍后重试"),$(".alert").html(e.responseText),$(".alert").removeClass("hidden")}),n}function getParam(e){if(paramValue="",isFound=!1,0==this.location.search.indexOf("?")&&this.location.search.indexOf("=")>1)for(arrSource=unescape(this.location.search).substring(1,this.location.search.length).split("&"),i=0;i<arrSource.length&&!isFound;)arrSource[i].indexOf("=")>0&&arrSource[i].split("=")[0].toLowerCase()==e.toLowerCase()&&(paramValue=arrSource[i].split("=")[1],isFound=!0),i++;return""==paramValue&&(paramValue=null),paramValue}function countDown(e){e.el.attr("disabled","true"),e.el.toggleClass("count_down"),console.log(e);var t=e.duration,n=e.el;setTimeout(function(){clearInterval(a),e.cb&&e.cb()},1e3*t),t--,n.text(t+" s ");var a=setInterval(function(){t--,console.log(t),n.text(t+" s ")},1e3)}function isEmpty(e){return void 0===e||null==e||""==e}$(document).ready(function(){var e=getParam("i");$("input[name=tracking]").val(e),$("#phone").attr("placeholder","请输入手机号"),bindRegByPhone(),$("#recipient-name").bind("input propertychange",function(){isEmpty($("#recipient-name").val())?$("button[name=btn-reg]").attr("disabled","true"):$("button[name=btn-reg]").removeAttr("disabled")})});