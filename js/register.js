function switchLang4register(e){switchLang(e),$("input[name=login]").attr("placeholder",$.i18n("placeholder_login")),$("input[name=phonenum]").attr("placeholder",$.i18n("placeholder_phonenum")),$("input[name=activecode]").attr("placeholder",$.i18n("placeholder_activecode")),$("input[name=password]").attr("placeholder",$.i18n("placeholder_password")),$("input[name=password2]").attr("placeholder",$.i18n("placeholder_password2")),$("input[name=tracking]").attr("placeholder",$.i18n("placeholder_tracking")),$("input[name=email]").attr("placeholder",$.i18n("placeholder_email"))}function bindRegEmailEvent(){$("#reg_email").find("input[name=login]").on("blur",function(e){var n=$(this),i="";userNameRules.map(function(e,t){i=e({el:n,minLength:6,maxLength:16,name:"username"}),t===userNameRules.length-1?n.siblings(".with-errors").text(i):n.siblings(".with-errors").text("")})}),$("input[name=email]").on("blur",function(e){var n=$(this),i=checkEmail(n.val());i?n.siblings(".with-errors").text(i):n.siblings(".with-errors").text("")}),$(".btn-send-email").on("click",function(e){var n=$(this),i=checkEmail($("input[name=email]").val());if(i)return void $("input[name=email]").siblings(".with-errors").text(i);$("input[name=email]").siblings(".with-errors").text("");var t=n.text();countDown({el:n,duration:60,cb:function(){n.text(t)}});$("input[name=email]").siblings(".with-errors").text("Verification code has been sended, please check it in your email!"),sendEmail({url:REGISTER_EMAIL,pram:$("#reg_email").serializeJSON()})}),$("input[name=activecode]").on("blur",function(e){var n=$(this),i=checkVerfyCode(n.val());i?n.siblings(".with-errors").text(i):n.siblings(".with-errors").text("")}),$("#reg_email").find("input[name=password]").on("blur",function(e){checkPass($("#reg_email").find("input[name=password]"),$("#reg_email").find("input[name=password2]"))}),$("#reg_email").find("input[name=password2]").on("blur",function(e){checkPass($("#reg_email").find("input[name=password]"),$("#reg_email").find("input[name=password2]"))}),$("#submit_email").on("click",function(e){e.preventDefault();$(this);if(!$("#reg_email").find("input[name=protocol_text]").is(":checked"))return $("#popUpModal").find(".modal-body").empty().text("Please check the protocol ( 请勾选协议 ) !"),void $("#popUpModal").modal({show:!0});$.each($("#reg_email").find("input"),function(e,n){$(n).trigger("blur")});var n="";if($.each($("#reg_email").find(".with-errors"),function(e,i){""!==$(i).text()&&(n+=$(i).text())}),n)return $("#popUpModal").find(".modal-body").empty().text("Please finish user info (请完善用户资料) !"),void $("#popUpModal").modal({show:!0});var i=$("#reg_email").serializeJSON();i.activeCode=i.activecode,i.nickname=i.login,$.ajax({url:REGISTER_URL_MAIL,method:"POST",data:JSON.stringify(i),contentType:"application/json"}).done(function(e,n,i){e.success?window.location.href=LOGIN_PAGE:($("#popUpModal").find(".modal-body").empty().text(e.message),$("#popUpModal").modal({show:!0}))}).fail(function(e,n,i){$(".alert").html(e.responseText),$(".alert").removeClass("hidden")})})}function bindRegPhoneEvent(){$("#reg_phone").find("input[name=login]").on("blur",function(e){var n=$(this),i="";userNameRules.map(function(e,t){i=e({el:n,minLength:6,maxLength:16,name:"username"}),t===userNameRules.length-1?n.siblings(".with-errors").text(i):n.siblings(".with-errors").text("")})}),$("input[name=phonenum]").on("blur",function(e){var n=$(this),i=checkPhone(n.val());i?n.siblings(".with-errors").text(i):n.siblings(".with-errors").text("")}),$(".btn-send-code").on("click",function(e){var n=$(this),i=checkPhone($("input[name=phonenum]").val());if(i)return void $("input[name=phonenum]").siblings(".with-errors").text(i);$("input[name=phonenum]").siblings(".with-errors").text("");var t=n.text();countDown({el:n,duration:60,cb:function(){n.text(t)}});$("input[name=phonenum]").siblings(".with-errors").text("Verification code has been sended, please check it!");var a=$("#reg_phone").serializeJSON();a.phoneNum=a.phonenum,sendSms({url:REGISTER_PHONE,pram:a})}),$("#submit_phone").on("click",function(e){$(this);if(e.preventDefault(),!$("#reg_phone").find("input[name=protocol_text]").is(":checked"))return $("#popUpModal").find(".modal-body").empty().text("Please check the protocol ( 请勾选协议 ) !"),void $("#popUpModal").modal({show:!0});$.each($("#reg_phone").find("input"),function(e,n){$(n).trigger("blur")});var n="";if($.each($("#reg_phone").find(".with-errors"),function(e,i){""!==$(i).text()&&(n+=$(i).text())}),n)return $("#popUpModal").find(".modal-body").empty().text("Please finish user info (请完善用户资料) !"),void $("#popUpModal").modal({show:!0});var i=$("#reg_phone").serializeJSON();i.activeCode=i.activecode,i.nickname=i.login,i.mobilePhoneNumber=i.phonenum,i.mobilePhoneAreaCode=i.areaCode,$.ajax({url:REGISTER_URL_PHONE,method:"POST",data:JSON.stringify(i),contentType:"application/json"}).done(function(e,n,i){e.success?window.location.href=LOGIN_PAGE:($("#popUpModal").find(".modal-body").empty().text(e.message),$("#popUpModal").modal({show:!0}))}).fail(function(e,n,i){$(".alert").html(e.responseText),$(".alert").removeClass("hidden")})}),$("#reg_phone").find("input[name=password]").on("blur",function(e){checkPass($("#reg_phone").find("input[name=password]"),$("#reg_phone").find("input[name=password2]"))}),$("#reg_phone").find("input[name=password2]").on("blur",function(e){checkPass($("#reg_phone").find("input[name=password]"),$("#reg_phone").find("input[name=password2]"))})}function getParam(e){if(paramValue="",isFound=!1,0==this.location.search.indexOf("?")&&this.location.search.indexOf("=")>1)for(arrSource=unescape(this.location.search).substring(1,this.location.search.length).split("&"),i=0;i<arrSource.length&&!isFound;)arrSource[i].indexOf("=")>0&&arrSource[i].split("=")[0].toLowerCase()==e.toLowerCase()&&(paramValue=arrSource[i].split("=")[1],isFound=!0),i++;return""==paramValue&&(paramValue=null),paramValue}var strategies={isNonEmpty:function(e){if(""===e.el.val())return e.name+" can't not be null"},minLength:function(e){if(e.el.val().length<e.minLength)return e.name+" minimum length can't less than "+e.minLength},maxLength:function(e){if(e.el.val().length>e.maxLength)return e.name+" minimum length can't more than "+e.minLength}},userNameRules=[strategies.isNonEmpty,strategies.minLength];$(document).ready(function(){bindRegPhoneEvent(),bindRegEmailEvent(),$(".use_phone").on("click",function(e){$(".reg_email, .reg_phone").toggleClass("hidden"),"register_by_email"===$.trim($(this).attr("data-i18n"))?($(this).attr("data-i18n","register_by_phone"),$(this).text($.i18n("register_by_phone"))):($(this).attr("data-i18n","register_by_email"),$(this).text($.i18n("register_by_email")))}),$(".logout").click(logout);var e=COUNTRY_MAP.map(function(e){return'<option value="'+e.langKey+'">'+e.value+"</option>"}).join("");$("select[name=langKey]").html(e);var n=COUNTRY_MAP.map(function(e){return'<option value="'+e.areaCode+'">'+e.value+"</option>"}).join("");$("select[name=areaCode]").html(n),$("#protocalModal").modal({show:!1});var i=getParam("i");null!=i?Cookies.set("invite_code",i):Cookies.set("invite_code",null),$("input[name='tracking']").each(function(){var e=getInviteCode();""!=e&&null!=e&&"null"!=e?($(this).val(e),$(this).attr("readonly","readonly")):($(this).val(""),$(this).removeAttr("readonly"))})}),$.i18n({locale:"en"}).load({en:"../i18n/en.json",zh:"../i18n/zh.json"}).then(function(){switchLang4register(1)});