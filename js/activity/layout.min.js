function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var _slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],o=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){n=!0,a=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();define("layout/util/dataPreparationsForAnchors",["lodash","warmupUtils"],function(e,t){"use strict";function i(e,i,o){return t.boundingLayout.getBoundingHeight({height:e,width:i,rotationInDegrees:o})}function o(e,o,n){var a=e.id,r=e.layout?e.layout.rotationInDegrees:0,s=n.height[a],u=n.top&&void 0!==n.top[a]?n.top[a]:e.layout&&e.layout.y||0;o.currentHeight[e.id]=r?i(s,n.width[a],r):s,o.heightDiff[a]=o.currentHeight[e.id]-s,o.currentY[a]=r?(c=u,l=s,g=n.width[a],d=r,t.boundingLayout.getBoundingY({y:c,height:l,width:g,rotationInDegrees:d})):u;var c,l,g,d;o.topDiff[a]=u-o.currentY[a]}function n(a,r,s,l,g,d){if(e.has(s.height,a.id)){!function(e,t,i){var o=e.id;e.layout&&e.layout.rotationInDegrees&&(t.noHeightChange[o]=!0),i.shrinkableContainer[o]?t.shrinkableContainer[o]=!0:("Document"===(n=e).type||"wysiwyg.viewer.components.PagesContainer"===n.componentType)&&(t.ignoreOriginalValue[o]=!0);var n}(a,r,s),o(a,r,s),r.minHeight[a.id]=function(t,o,n){var a=t.id;if(a&&(!(r=a)||!e.includes(u,r))){return i(Math.max(n.minHeight[a]||0,c),o,t.layout.rotationInDegrees)}var r;return n.minHeight[a]||0}(a,s.width[a.id]||a.layout.width,r),r.currentHeight[a.id]=Math.max(r.currentHeight[a.id],r.minHeight[a.id]),r.collapsed[a.id]&&(r.currentHeight[a.id]=0),r.flat[a.id]=a;var h=l+r.currentY[a.id]-g,p=r.currentHeight[a.id];r.sortingY[a.id]=h,r.valueForFirstLockedAnchor[a.id]={pusherId:null,value:-Number.MAX_VALUE};var m=t.dataUtils.getChildrenData(a,d);e.forEach(m,function(e){n(e,r,s,h,p||5e3,d)})}}function a(e,t,i){return{distance:i,type:e,targetComponent:t,locked:!0,notEnforcingMinValue:!0}}function r(t,i,o,n){var r=t;return t.$cloned||((r=e.clone(r)).layout=e.clone(r.layout),r.layout.anchors=e.clone(r.layout.anchors),r.$cloned=!0),r.layout.anchors.push(a("TOP_TOP",i,o),a("BOTTOM_BOTTOM",i,n)),r}function s(t){return"wysiwyg.viewer.components.PopupContainer"===(e.get(t,"components.length")&&e.get(t,"components[0].componentType"))}var u=["WIX_ADS"],c=5;return{getDataForAnchorsAndSort:function(t,i,o){var a={flat:{},sortingY:{},minHeight:{},shrinkableContainer:{},ignoreOriginalValue:{},noHeightChange:{},containerHeightMargin:{},currentHeight:{},currentY:{},heightDiff:{},topDiff:{},locked:{},valueForFirstLockedAnchor:{}};a.containerHeightMargin=i.containerHeightMargin||{},a.minHeight=e.clone(i.minHeight||{}),a.collapsed=e.clone(i.collapsed||{}),a.injectedAnchors=i.injectedAnchors||{},a.__isPopup=s(t),n(t,a,i,0,0,o),u=a.flat,e.forEach(u,function(t,i){if(t.layout&&t.layout.anchors){var o=e.filter(t.layout.anchors,{type:"LOCK_BOTTOM"});e.isEmpty(o)||(e.forEach(o,function(e){u[i]=r(u[i],e.targetComponent,e.topToTop,e.distance),u[e.targetComponent]=r(u[e.targetComponent],i,-1*e.topToTop,-1*e.distance)}),e.remove(u[i].layout.anchors,{type:"LOCK_BOTTOM"}))}});var u,c=e.sortBy(e.keys(a.flat),function(e){return a.sortingY[e]});return delete a.sortingY,{structureData:a,sortedIds:c}},fixMeasureMap:function(t,i){e.forEach(i.flat,function(e,o){t.height[o]=i.currentHeight[o]-i.heightDiff[o],t.top[o]=s(e)?0:i.currentY[o]+i.topDiff[o]})},maxMeasureMapHeight:function i(o,n,a,r){if(!e.has(o.height,r.id))return 0;n=n||0,n+=o.top[r.id];var s=t.dataUtils.getChildrenData(r,a);return s=e.reject(s,{layout:{fixedPosition:!0}}),Math.max(n+o.height[r.id],Math.max.apply(null,e.map(s,e.partial(i,o,n,a))))}}}),define("layout/util/anchors",["lodash","layout/util/dataPreparationsForAnchors"],function(e,t){"use strict";function i(e,t){return(t?m.MOBILE:m.DESKTOP)[e.componentType]}function o(e,t,i,o){return t!==i&&(o.dirty[e]=!0,o.changedCompsMap[e]=o.flat[e]),o.dirty[e]}function n(t,i,o,n){var a=o[n.targetComponent],r=o[i];n.notEnforcingMinValue&&!e.isEmpty(r)&&(n.notEnforcingMinValue=!1),a[i]=t;var s=Math.max.apply(null,e.values(a));return n.notEnforcingMinValue&&delete a[i],s}function a(e,t,i,o,n){var a=e.targetComponent,r=t.valueForFirstLockedAnchor[a];r&&(e.locked||null===n?(r.pusherId&&(i[a]={},i[a][r.pusherId]=r.value),delete t.valueForFirstLockedAnchor[a]):(r.pusherId=o,r.value=Math.max(n,r.value)))}function r(e,t){return t-=(t-e)%1}function s(t,i){return e.has(t.currentHeight,i)}function u(t,i){return o=t,n=i,e.get(o.collapsed,n.fromComp,!1)&&e.includes([g,d],n.type)?0:i.distance;var o,n}function c(e,t,i,o){var n=void 0;return o.shrinkableContainer[i]?n=t:e.locked?n=t+u(o,e):(n=t+h,o.ignoreOriginalValue[i]||(n=Math.max(n,e.originalValue))),n}function l(t,i,o,n){var a=t;return e.isNumber(n.minHeight[i])&&t<n.minHeight[i]&&(a=n.minHeight[i],o.notEnforcingMinValue&&(o.notEnforcingMinValue=!1,n.dirty[i]=!0,n.changedCompsMap[i]=n.flat[i])),a}var g="BOTTOM_TOP",d="BOTTOM_PARENT",h=10,p=["Page","Document"],m={MOBILE:{"mobile.core.components.MasterPage":!0,"wysiwyg.viewer.components.HeaderContainer":!0,"wysiwyg.viewer.components.SiteRegionContainer":!0,"wysiwyg.viewer.components.PagesContainer":!0,"wysiwyg.viewer.components.PageGroup":!0,"wysiwyg.viewer.components.FooterContainer":!0,"wysiwyg.viewer.components.SiteBackground":!0},DESKTOP:{"mobile.core.components.MasterPage":!0,"wysiwyg.viewer.components.HeaderContainer":!0,"wysiwyg.viewer.components.PagesContainer":!0,"wysiwyg.viewer.components.PageGroup":!0,"wysiwyg.viewer.components.FooterContainer":!0,"wysiwyg.viewer.components.SiteBackground":!0}},f={};return f.TOP_TOP=function(t,i,c){var l=i.targetComponent;if(!s(c,l)||!s(c,t))return!1;if(e.has(c.locked,l))return!1;var g=c.currentY[l],d=c.currentY[t]+u(c,i);return a(i,c,c.toTopAnchorsY,t,null),d=r(g,d=n(d,t,c.toTopAnchorsY,i)),c.currentY[l]=d,o(l,g,d,c)},f[g]=function(t,i,c){var l=i.targetComponent;if(!s(c,l)||!s(c,t))return!1;if(e.has(c.locked,l))return!1;var g=c.currentY[l],d=c.currentHeight[t]+c.currentY[t],p=null;return i.locked?d+=u(c,i):(p=d+h,d=c.valueForFirstLockedAnchor[l]?Math.max(d+h,i.originalValue):p),d=Math.max(d,c.currentY[t]+c.currentHeight[t]/2),a(i,c,c.toTopAnchorsY,t,p),d=r(g,d=n(d,t,c.toTopAnchorsY,i)),c.currentY[l]=d,o(l,g,d,c)},f[d]=function(t,i,a){var r=i.targetComponent;if(e.get(a.collapsed,r))return!1;if(!s(a,r)||!s(a,t))return!1;if(e.has(a.locked,r))return!1;if(a.flat[r].layout&&a.flat[r].layout.rotationInDegrees)return!1;var u=a.currentHeight[r],g=c(i,a.currentHeight[t]+a.currentY[t]+(a.containerHeightMargin[r]||0),r,a);return g=n(g=l(g,r,i,a),t,a.toBottomAnchorsHeight,i),a.currentHeight[r]=g,o(r,u,g,a)},f.BOTTOM_BOTTOM=function(t,i,a){if(a.ignoreBottomBottom)return!1;var r=i.targetComponent;if(!s(a,r)||!s(a,t))return!1;if(e.has(a.locked,r))return!1;if(a.flat[r].layout&&a.flat[r].layout.rotationInDegrees)return!1;var u=a.currentHeight[r],g=c(i,a.currentHeight[t]+a.currentY[t]-a.currentY[r],r,a);return g=n(g=l(g,r,i,a),t,a.toBottomAnchorsHeight,i),a.currentHeight[r]=g,o(r,u,g,a)},{enforceAnchors:function(o,n,a,r,s,u,c,l){var g=t.getDataForAnchorsAndSort(o,n,r),d=g.structureData,h=g.sortedIds,m=e.invert(h);d.dirty={},d.toTopAnchorsY={},d.toBottomAnchorsHeight={},d.locked=u,d.changedCompsMap=d.flat,d.ignoreBottomBottom=!!l,e.forEach(d.flat,function(e,t){d.dirty[t]=!0,d.toTopAnchorsY[t]={},d.toBottomAnchorsHeight[t]={}}),c&&(d.changedCompsMap=e.pick(d.flat,e.keys(c)));var y=function(t,o,n,a,r,s,u){for(var c=!1,l=t.length,g=0;g<l;){var d=function(t){var l,g,d,h=(l=t,g=a,d=n,"masterPage"===l?[]:d.injectedAnchors[l]||g[l]||[]),p=Number.MAX_VALUE;return!n.dirty[t]||r&&!i(n.flat[t],u)||e.forEach(h,function(e){if(f[e.type]&&n.flat[e.targetComponent]&&(!r||i(n.flat[e.targetComponent],u))){e.targetComponent===s&&(c=!0);var a=f[e.type](t,e,n)?o[e.targetComponent]:Number.MAX_VALUE;p=Math.min(a,p)}}),n.dirty[t]=!1,p}(t[g]);g=Math.min(g+1,d)}return c}(h,m,d,a,s,o.id,r);if(t.fixMeasureMap(n,d),!y&&e.includes(p,o.type)){var w=n.height[o.id];n.height[o.id]=t.maxMeasureMapHeight(n,0,r,o),n.height[o.id]!==w&&(d.changedCompsMap[o.id]=d.flat[o.id])}return d.changedCompsMap},HARD_WIRED_COMPS_TO_RELAYOUT:{SITE_FOOTER:!0,SITE_HEADER:!0,SITE_PAGES:!0,PAGES_CONTAINER:!0,masterPage:!0,SITE_BACKGROUND:!0}}}),define("layout/util/layoutAlgorithm",["lodash","warmupUtils","layout/util/anchors"],function(e,t,i){"use strict";function o(o,n,a,r,s,u,c,l,g){var d=s?t.constants.VIEW_MODES.MOBILE:t.constants.VIEW_MODES.DESKTOP,h=e.get(a,[o.id,d]);return h?i.enforceAnchors(o,n,h,s,u,c,l,g):function(i,o,n){var a={};return function i(r){e.has(o.height,r.id)&&(a[r.id]=r,e.forEach(t.dataUtils.getChildrenData(r,n),i))}(i),a}(o,n,s)}function n(t,i){return e.has(t.height,i)}function a(i,o,a){var r=t.dataUtils.getChildrenData(o,a),s=e.find(r,{id:"SITE_FOOTER"});i.height.masterPage=function(i,o,a){var r=0;return function i(s,u){if(u=u||0,n(o,s.id)){var c=u+o.top[s.id]+o.height[s.id];c>r&&(r=c);var l=t.dataUtils.getChildrenData(s,a);e.forEach(l,function(e){i(e,u+o.top[s.id])})}}(i),r||i.layout.y+i.layout.height}(s,i,a)}function r(t,i,o){var a,r;return a=t,r=i,e(r).map(function(e){return n(a,e.id)?(t=a,i=e.id,t.top[i]+t.height[i]):0;var t,i}).max()-t.top.PAGES_CONTAINER-o}function s(i,o,n,s,u){var l=function(i,o){var n=t.dataUtils.getChildrenData(i,o);return e.reject(n,function(t){return c[t.id]||e.get(t,["layout","fixedPosition"])})}(o,u);if(!e.isEmpty(l)){var g=e.get(s,["pagesToFooterGap"],0),d=r(i,l,g);d>i.height.PAGES_CONTAINER&&(i.height.PAGES_CONTAINER=d,i.height.SITE_PAGES=d,n&&(i.height[n.pageId]=d),i.top.SITE_FOOTER=i.top.PAGES_CONTAINER+d+g)}a(i,o,u)}function u(i,o){var n=t.DALFactory.getPointersInstance(o),a=t.DALFactory.getInstance(o),r=i&&a.get(n.data.getDataItem(i,o.MASTER_PAGE_ID));return e.get(r,"ignoreBottomBottomAnchors")}var c={SITE_FOOTER:!0,SITE_HEADER:!0,PAGES_CONTAINER:!0};return{enforceStructure:o,enforceAllStructures:function(t,i,a,r,c,l){var g={},d=void 0,h=void 0;a.originalValuesMap=a.originalValuesMap||{};var p=a.isMobileView();return t.inner&&(h=e.get(t,"inner.structure.id"),d=u(h,a),g.inner=o(t.inner.structure,i,a.anchorsMap,a.originalValuesMap,p,r,c,l,d),i.height.SITE_PAGES&&(i.height.SITE_PAGES=i.height[t.inner.pageId])),e.forOwn(t,function(m,f){if("inner"!==f&&(h=e.get(m,["structure","id"]),d=u(h,a),g[f]=o(m.structure,i,a.anchorsMap,a.originalValuesMap,p,r,c,l,d)),"outer"===f&&!p&&(w=i,n(w,"SITE_HEADER"))){var y=a.getMasterPageLayoutSettings();y.useDesktopSectionsLayout&&s(i,m.structure,t.inner,y,p)}var w}),g}}}),define("layout/util/createDOMPatchers",["zepto","lodash","warmupUtils"],function(e,t,i){"use strict";function o(t,o,n){t[o]?e(t[o]).css(n):i.log.error("Cannot find node with id {"+o+"} to patch css. Either the node doesn't exist, or it was never measured, or it was measured under a different id.")}function n(t,o,n){t[o]?e(t[o]).attr(n):i.log.error("Cannot find node with id {"+o+"} to patch attributes. Either the node doesn't exist, or it was never measured, or it was measured under a different id.")}function a(e,o,n){e[o]?t.forOwn(n,function(t){e[o].setAttributeNS(t.ns,t.attribute,t.value)}):i.log.error("Cannot find node with id {"+o+"} to patch attributesNS. Either the node doesn't exist, or it was never measured, or it was measured under a different id.")}function r(e,o,n){e[o]?t.forEach(t.keys(n),function(t){e[o][t]=n[t]}):i.log.error("Cannot find node with id {"+o+"} to patch events. Either the node doesn't exist, or it was never measured, or it was measured under a different id.")}function s(o,n,a){if(o[n]){var r=e(o[n]);t.forOwn(a,function(e,t){r.data(t,e)})}else i.log.error("Cannot find node with id {"+n+"} to patch data. Either the node doesn't exist, or it was never measured, or it was measured under a different id.")}return function(e){return{css:t.partial(o,e),attr:t.partial(n,e),attrNS:t.partial(a,e),data:t.partial(s,e),events:t.partial(r,e)}}}),define("layout/util/singleCompLayout",["lodash","zepto","warmupUtils","experiment"],function(e,t,i,o){"use strict";function n(e){return"fixed"===e.position}function a(t,i,o,n){var a=e.get(n,"layout.width",0);r=n,d.isHorizontallyStretched(r.layout)?t.width[i]=o.offsetWidth:f[n.componentType]||!e.get(n,"layout.width")?t.width[i]=Math.max(o.offsetWidth,a):t.width[i]=a;var r}function r(t,i,o,n){var a=e.get(n,"layout.height",0),r=e.get(n,"layout.aspectRatio",0);r&&(a=r*t.width[i]),s=n,d.isVerticallyStretched(s.layout)?t.height[i]=o.offsetHeight:f[n.componentType]||!e.get(n,"layout.height")?t.height[i]=Math.max(o.offsetHeight,a):t.height[i]=a;var s}function s(t,o,s,u,c){if(u.isDeadComp[t])!function(t,i,o,n){var a=e.get(n,"layout.width",0),r=e.get(n,"layout.height",0);t.width[i]=a,t.height[i]=r}(u,t,0,s);else{var l=window.getComputedStyle(o);g=u,h=t,p=o,n(l)&&(g.fixed[h]=!0,g.top[h]=p.offsetTop,g.left[h]=p.offsetLeft);var g,h,p;!function(e,t,i){var o=i.zIndex;"auto"!==o&&(o=parseFloat(o),isNaN(o)||(e.zIndex[t]=o))}(u,t,l),a(u,t,o,s),r(u,t,o,s),c.getLayoutMechanism()===i.constants.LAYOUT_MECHANISMS.MESH&&(m=t,f=o,u.top[m]=f.offsetTop);var m,f;n(l)||(u.left[t]=function(t,i){var o=e.get(t,"layout.x",0),n=i.offsetLeft,a=d.getMeasurerForElement(i);return a&&(n-=a.offsetLeft),Math.abs(o-n)<=.5?o:n}(s,o))}}function u(e){return e.getAttribute("data-dead-comp")}function c(e,t){return!!e&&(t(e)||!1)}function l(e,t){S[e]&&console.warn(e+" is already registered to 'registerCustomLayoutFunction'"),S[e]=t}var g,d=i.layoutUtils,h=i.style.unitize,p={},m={},f={},y={},w={},v=new WeakMap,C=i.constants.LAYOUT_MECHANISMS.ANCHORS,M=(g=v,function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=g.get(e)||[];g.set(e,i.concat(t))}}),S={},I=function(o,n,a){var r=M(n),s=i.constants.COMP_LAYOUT_OPTIONS.CHANGES_TYPES,u=[s.data];if(e.isFunction(a))r([a]);else if(e.isArray(a)){var c=e(a).reject(function(t){return e.isEmpty(t.changes)}).map(function(e){return e.id=e.node.getAttribute("id"),e}).value();!function(i){var o=Object.keys(s),n=i.map(function(i){var n=i.type,a=i.node,r=i.changes;if(!o.includes(n))throw new Error("can not use type "+n+" for patching. only types "+o+" are allowed");return u.includes(n)?function(){var i=t(a);e.forOwn(r,function(e,t){i[n](t,e)})}:function(){return t(a)[n](r)}});r(n)}(c),function(t){var i={height:"height","min-height":"minHeight","min-width":"minWidth",width:"width",top:"top"},n=Object.keys(i);e(t).filter({type:s.css}).map(function(t){var o=t.id,a=t.changes,r=e.pick(a,n);return e(r).mapKeys(function(e,t){return i[t]}).transform(function(e,t,i){e[i]=e[i]||{},e[i][o]=t},{}).value()}).forEach((a=o,function(t){return e.merge(a,t)}));var a}(c)}};return{patchComponent:function(t,n,a,r,s){var u=i.layoutUtils.getLayoutMechanism(s),c=t.id,l=t.layout;if(u===C&&function(t,i,o,n){var a={};n&&(d.isVerticallyDocked(n)&&!d.isVerticallyStretchedToScreen(n)||(a.top=h(o.top[t])),d.isVerticallyStretched(n)&&!d.isVerticallyStretchedToScreen(n)||(a.height=h(o.height[t])),e.isEmpty(a)||i.css(t,a))}(c,n,r,l),o.isOpen("sv_noSpecificCompLayout",s))return!1;var g=a[t.id],m=v.get(g);e.forEach(m,function(e){return e(n)}),!r.isDeadComp[c]&&p[t.type]&&p[t.type](c,n,r,t,s)},measureComponent:function(i,o,n,a,r,l){var g=o.id,d=c(g,n);if(d&&(v.set(d,[]),r[g]=d,a.isDeadComp[g]=u(d),s(g,d,i,a,l),!a.isDeadComp[g]&&!l.isExperimentOpen("sv_noSpecificCompLayout"))){var h=l.getSiteData();m[o.type]&&m[o.type](g,a,r,h,o),function(t,i,o,n,a,r){if(w[t]){var s=w[t];e.isFunction(s)?s(i,o,n,a,r):e.isPlainObject(s)&&e.forEach(e.values(s),function(e){return e(i,o,n,a,r)})}}(o.type,g,a,r,h,o);var p=h.getLayoutFunc(d);p&&I(a,d,p(d,t)),S[o.type]&&I(a,d,S[o.type](g,r,a,h,o))}},measureComponentChildren:function(t,i,o,n,a){var r=t.id,s=c(r,i);if(s&&!u(s)&&y[t.type]){var l=y[t.type];"function"==typeof l&&(l=l(r,n,t,a)),e.forEach(l,function(s){var u=e.isPlainObject(s),c=u?s.pathArray:s,l=i.apply(void 0,[r].concat(c))||i.apply(void 0,[r,"component"].concat(c));if(l){var g=c.join(""),d=r+g;n[d]=l,o.height[d]=l.offsetHeight,o.width[d]=l.offsetWidth,u&&m[s.type]&&m[s.type](d,o,n,a,t)}})}},isComponentDead:u,registerPatcher:function(e,t){p[e]=t},registerPatchers:function(t,i){p[t]=function(){var t=arguments;e.forEach(i,function(e){e.apply(null,t)})}},registerCustomMeasure:function(e,t){m[e]=t},registerCustomLayoutFunction:l,registerCustomDomChangesFunction:function(e,t){l(e,function(e,i){return t(i[e])})},registerRequestToMeasureDom:function(e){f[e]=!0},registerRequestToMeasureChildren:function(e,t){y[e]=t},registerAdditionalMeasureFunction:function(t,i,o){e.isString(o)&&!e.isEmpty(o)?(w[t]=e.isPlainObject(w[t])?w[t]:{},w[t][o]=i):w[t]=i}}}),define("layout/util/bodyNodePatcher",["zepto","lodash","experiment"],function(e,t,i){"use strict";return{updateBodyNodeStyle:function(o){var n=e("body"),a=e("html");if(o.isQaMode()&&n.addClass("qa-mode"),i.isOpen("sv_noSpecificCompLayout")||n.attr("data-js-loaded",!0),o.isMobileView()?(n.addClass("device-mobile-optimized"),a.addClass("device-mobile-optimized")):o.isMobileDevice()||o.isTabletDevice()?n.addClass("device-mobile-non-optimized"):(n.removeClass("device-mobile-optimized").removeClass("device-mobile-non-optimized"),a.removeClass("device-mobile-optimized")),o.isMobileDevice()){var r=t.assign({},o.os,o.browser),s=t(r).keys().filter(function(e){return!0===r[e]}).map(function(e){return"device-"+e}).join(" ");a.addClass(s)}var u=n.css("overflow"),c=o.renderFlags.allowSiteOverflow?null:"hidden";u!==c&&n.css("overflow",c)}}}),define("layout/util/iframesPatcher",["zepto","lodash","tpaWarmup"],function(e,t,i){"use strict";return{setIframesSrc:function(o,n){var a=(o||e)("iframe[data-src]");t.forEach(a,function(e){var t=e.getAttribute("src"),o=e.getAttribute("data-src");o&&(t!==o&&(e.setAttribute("src",o),function(e,t){var o=e.getAttribute("name");i.isTpaSupportedInWarmup(t,o)&&i.reportWarmupPerformanceBiEvent(i.events.APP_IFRAME_START_LOADING,t,o)}(e,n)),e.removeAttribute("data-src"))})}}}),define("layout/util/layout",["zepto","lodash","layout/util/anchors","layout/util/layoutAlgorithm","warmupUtils","layout/util/createDOMPatchers","layout/util/singleCompLayout","layout/util/bodyNodePatcher","layout/util/iframesPatcher","experiment"],function(e,t,i,o,n,a,r,s,u,c){"use strict";function l(e,i){var o=t.last(e),a=n.dataUtils.getChildrenData(o,i);return t.transform(a,function(e,t){e[t.id]=!0},{})}function g(e){var i=e[e.length-2];return t.set({},i.id,!0)}function d(e,t,i){return e&&Math.max(t,Math.min(i,e))}function h(e,i,o){var a,r=i.getSiteData(),s=t.clone(e.layout),u={dataItem:e.dataItem||null,propertiesItem:e.propertiesItem||null,layout:s,styleItem:null,id:e.id,type:(a=e,a.componentType||a.documentType),structure:e,rootId:o};return u.layout&&(t.isFinite(u.layout.height)&&(u.layout.height=d(u.layout.height,n.siteConstants.COMP_SIZE.MIN_HEIGHT,n.siteConstants.COMP_SIZE.MAX_HEIGHT)),t.isFinite(u.layout.width)&&(u.layout.width=d(u.layout.width,n.siteConstants.COMP_SIZE.MIN_WIDTH,n.siteConstants.COMP_SIZE.MAX_WIDTH))),e.dataQuery&&!u.dataItem&&(u.dataItem=r.getDataByQuery(e.dataQuery,o)),e.propertyQuery&&!e.propertiesItem&&(u.propertiesItem=r.getDataByQuery(e.propertyQuery,o,r.dataTypes.PROPERTIES)),(e.behaviorQuery||e.behaviors)&&(u.behaviorsItem=e.behaviors||t.get(r.getDataByQuery(e.behaviorQuery,o,r.dataTypes.BEHAVIORS),"items")),e.designQuery&&(u.designDataItem=r.getDataByQuery(e.designQuery,o,r.dataTypes.DESIGN)),e.styleId&&(u.styleItem=r.getDataByQuery(e.styleId,o,r.dataTypes.THEME)),u}function p(e,i,o,n,a,s){var u=a.getSiteData(),c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return r.patchComponent.apply(r,[e].concat(t))}}(e,i,n,u);t(o).keys().filter(function(e){return t=e,!Boolean(n.collapsed[t])&&i[e];var t}).map(function(e){return h(o[e],a,s)}).forEach(c)}function m(e,i,o,n,r){var s=a(o);t.forEach(e,function(e,t){p(s,o,n[t],i,r,e.pageId)})}function f(t,i,o,n,a,r,s){var u=e(i(t.id));u.attr("data-leaving")||(x[t.componentType]?function(e,t,i,o,n,a,r){var s=h(e,n,a);y(e,t,o),w(s,n,t,i,o,a,r),v(s,t,i,o,n,e,r)}(t,i,o,n,a,r,s):function(e,t,i,o,n,a,r){var s=h(e,n,a);y(e,t,o),v(s,t,i,o,n,e,r),w(s,n,t,i,o,a,r)}(t,i,o,n,a,r,s),u.attr("data-hidden")?o.isHidden[t.id]=!0:o.isHidden[t.id]=!1)}function y(e,t,i){var o=t(e.id);o&&(i[e.id]=o)}function w(e,i,o,a,r,s,u){var c=i.getSiteData(),l=n.dataUtils.getChildrenData(e.structure,c.isMobileView());t.forEach(l,function(e){f(e,o,a,r,i,s,u)})}function v(t,i,o,n,a,s,u){if(!(c=u)||c[t.id]){var c,l=e(i(s.id));o.collapsed[s.id]=!!l.attr("data-collapsed"),r.measureComponentChildren(t,i,o,n,a.getSiteData()),r.measureComponent(s,t,i,o,n,a)}}function C(e,i,o){var a=t.sortBy(t.keys(e),function(e){return"inner"===e?1:0});t.forEach(a,function(a){!function e(i,o,a,r,s,u){var c=i.id;if(u=u||o.fixed[c],c){var l=o.top[c]||0,g=o.left[c]||0;o.fixed[c]?(r=l,s=g):(r+=l,s+=g),o.absoluteTop[c]=r,o.absoluteLeft[c]=s,u&&(o.shownInFixed[c]=!0)}var d=n.dataUtils.getChildrenData(i,a);t.forEach(d,function(t){e(t,o,a,r,s,u)})}(e[a].structure,i,o,"inner"===a?i.absoluteTop.SITE_PAGES:0,"inner"===a?i.absoluteLeft.SITE_PAGES:0)})}function M(e,o,n,a,r,s,u,c){var l=[],g={},d=r.getSiteData(),p=d.isMobileView();return t.forEach(e,function(e){var n=h(e.structure,r),m=E[n.structure.componentType].measure(n,e.domNode,o,a,d,function(t){f(t,e.getDomNodeFunc,o,a,r,n.rootId,c)},function(t){return i.enforceAnchors(t,o,e.anchorsMap,p,u,s,c)});m&&(m.needsAdditionalInnerLayout&&l.push(e),m.changedCompsMap&&t.assign(g,m.changedCompsMap),m.needsParent&&c&&(c[e.parentId]=!0))}),t.forEach(e,function(e){var t=h(e.structure,r);e.skipPatch||E[t.structure.componentType].patch(t,o,n,a,r.getSiteData())}),{compsToInnerLayoutAgain:l,changedComps:g}}function S(e,i,o,s,u,c,l){var g=s.getSiteData(),d=g.getViewMode(),h={},p=[];t.forOwn(e,function(e){var i=t.get(e,"structure.id"),o=t.get(g.anchorsMap,[i,d]);!function e(i,o,a,s,u,c,l){var g=i.id&&o(i.id);if(g&&r.isComponentDead(g))return!1;var d=!c||!!c[i.id],h=a.getSiteData().isMobileView(),p=n.dataUtils.getChildrenData(i,h),m=t.reduce(p,function(t,n){return e(n,o,a,s,u,c,i.id)||t},!1),f=d||m;return g&&E[i.componentType]&&f&&s.push({anchorsMap:u,structure:i,getDomNodeFunc:o,domNode:g,parentId:l}),f}(e.structure,e.getDomNodeFunc,s,p,o,l,null)});for(var m=p,f=0,y=a(o);m.length&&f<3;){var w=M(m,i,y,o,s,u,c,l);m=w.compsToInnerLayoutAgain,h=t.assign(h,w.changedComps),f++}return h}function I(i,o){var n=(R=e("#SITE_ROOT")).offset()||{top:0},a=c.isOpen("onboardingviewportmode")?function(e){var i=t.get(e.renderFlags,"onboardingViewportMode","auto");return"parent"===i?window.parent.document.documentElement.clientHeight:/fixed:/.test(i)?parseInt(i.split(":")[1],10):window.document.documentElement.clientHeight}(i):window.document.documentElement.clientHeight,r=i.mobile.getScreenDimensions();o.clientWidth=i.getBodyClientWidth(),o.clientHeight=a,o.width.screen=i.getScreenWidth(),o.width.site=i.getSiteWidth(),o.height.screen=o.clientHeight,o.innerHeight.screen=window.innerHeight,o.innerWidth.screen=window.innerWidth,o.height.device=r.height,o.width.device=r.width,o.availHeight.device=r.availHeight,o.availWidth.device=r.availWidth,o.devicePixelRatio=i.mobile.getDevicePixelRatio(),o.siteOffsetTop=n.top,o.siteMarginBottom=t.parseInt(R.css("padding-bottom"),10)||0,o.custom.wixTopAdHeight=i.getWixTopAdHeight()}function b(e,i,o){var a=t.last(e),r={};i[a.id]&&t.assign(r,function(e,i){var o=null,n=t.last(e);if(n&&e.length>1){var a=t.get(e,e.length-2);"wysiwyg.viewer.components.Group"===a.componentType&&((o={})[a.id]=!0)}return n&&D[n.componentType]?t.defaults({},o,D[n.componentType](e,i)):o}(e,o));var s=n.dataUtils.getChildrenData(a,o);return t.forEach(s,function(n){t.assign(r,b(e.concat([n]),i,o))}),r}function T(e,o,a,r,s){var u={};return t.assign(u,o,a,i.HARD_WIRED_COMPS_TO_RELAYOUT,n.arrayUtils.toTrueObj(r)),t.assign(u,function(e,i,o){var n={};return t.forOwn(i,function(i){t.assign(n,b([i.structure],e,o))}),n}(u,e,s)),u}function A(e){var i=t(e).values().flatMap(t.keys).value();return n.arrayUtils.toTrueObj(i)}var L={},E={},x={},P=n.loggingUtils.performanceMetrics.RE_LAYOUT,D={"wysiwyg.viewer.components.Group":l,"wysiwyg.viewer.components.BoxSlideShow":l,"wysiwyg.viewer.components.StripContainerSlideShow":l,"wysiwyg.viewer.components.StripColumnsContainer":l,"wysiwyg.viewer.components.Column":function(e,i){var o=e[e.length-2],a=n.dataUtils.getChildrenData(o,i),r=[o].concat(a);return t.transform(r,function(e,t){e[t.id]=!0},{})},"wysiwyg.viewer.components.StripContainerSlideShowSlide":g,"wysiwyg.viewer.components.BoxSlideShowSlide":g},R=void 0,B=function(e){return!t.isEmpty(t.get(e,"inner.pageId"))||!t.isEmpty(e.pageId)};return{registerLayoutInnerCompsFirst:function(e,t,i){E[e]={measure:t,patch:i}},registerMeasureChildrenFirst:function(e,t){x[e]=t},registerPatcher:function(e,t){r.registerPatcher(e,t)},registerPatchers:function(e,t){r.registerPatchers(e,t)},registerCustomMeasure:function(e,t){r.registerCustomMeasure(e,t)},registerCustomLayoutFunction:function(e,t){r.registerCustomLayoutFunction(e,t)},registerCustomDomChangesFunction:r.registerCustomDomChangesFunction,registerAdditionalMeasureFunction:function(e,t,i){r.registerAdditionalMeasureFunction(e,t,i)},registerRequestToMeasureDom:function(e){r.registerRequestToMeasureDom(e)},registerRequestToMeasureChildren:function(e,t){r.registerRequestToMeasureChildren(e,t)},registerShapesMeasureFunction:function(e,i){t.forEach(e,function(e){return r.registerAdditionalMeasureFunction(e,i)})},updateBodyNodeStyle:s.updateBodyNodeStyle,reLayout:function(e,i,a,r,s,c){n.loggingUtils.performance.start(P),i.getLayoutMechanism()===n.constants.LAYOUT_MECHANISMS.MESH&&(s=null);var l=i.getSiteData(),g=l.isMobileView();delete e[void 0];var d,h,p=function(e,i){var o=L[e.siteId]||{};return t.omitBy(o,t.keys(i))}(l,s),y=s?(d=l.measureMap,h=s,t.forOwn(h,function(e,t){delete d.top[t],delete d.height[t],delete d.zIndex[t]}),d):{pageBottomByComponents:{},collapsed:{},isHidden:{},height:{},width:{},availHeight:{},availWidth:{},innerWidth:{},innerHeight:{},custom:{},containerHeightMargin:{},minHeight:{},minWidth:{},top:{},left:{},absoluteTop:{},absoluteLeft:{},fixed:{},shownInFixed:{},zIndex:{},isDeadComp:{},clientWidth:0,skipPatch:{},shrinkableContainer:{},injectedAnchors:{}};I(l,y);var w=S(e,y,p,i,r,a,s);s&&(s=T(e,s,w,i.getAllRenderedRootIds(),g)),v=e,M=y,b=p,E=i,x=s,t.forOwn(v,function(e){f(e.structure,e.getDomNodeFunc,M,b,E,e.pageId,x)});var v,M,b,E,x;!function(e,i){var o=t.filter(t.values(i),B);t.forEach(o,function(t){var i=t.pageId||t.inner.pageId;e.shrinkableContainer[i]=!0,e.left[i]=0})}(y,e);var D,R,H,_=i.getLayoutMechanism()===n.constants.LAYOUT_MECHANISMS.ANCHORS?o.enforceAllStructures(e,y,l,a,r,s):(D=e,R=y,H=l.isMobileView(),t.mapValues(D,function(e){return function e(i,o){return t.has(R.height,o.id)?t.assign(_defineProperty({},o.id,o),i,t.reduce(n.dataUtils.getChildrenData(o,H),e,{})):i}({},e.structure)}));return C(e,y,g),m(e,y,p,_,i),l.imageLoader.loadAllImages(l),u.setIframesSrc(c,l),L[l.siteId]=p,n.loggingUtils.performance.finish(P,l.isViewerMode()),{measureMap:y,reLayoutedCompsMap:A(_)}},enforceAndPatch:function(e,t){var i=t.getSiteData(),n=i.measureMap,a=o.enforceAllStructures(e,n,i,!1,null,{}),r=L[i.siteId];return C(e,n,i.isMobileView()),m(e,n,r,a,t),A(a)},enforceAnchors:i.enforceAnchors}}),define("layout/util/rootLayoutUtils",["lodash","warmupUtils"],function(e,t){"use strict";var i=t.layoutUtils,o={IMAGE_REF:"image",SVG_REF:"svg",RECT_REF:"rect",PATTERN_REF:"pattern"};return{measureNodeImage:function(t,i,n,a,r){var s=void 0,u=!1;n[t+o.IMAGE_REF]=n[t].querySelector("img")||n[t].querySelector("image"),n[t+o.IMAGE_REF]&&(n[t+o.SVG_REF]=n[t].querySelector("#svg"+t),n[t+o.RECT_REF]=n[t+o.SVG_REF]&&n[t+o.SVG_REF].querySelector("rect"),n[t+o.PATTERN_REF]=n[t].querySelector("pattern"),n[t+o.IMAGE_REF]&&"image"===n[t+o.IMAGE_REF].nodeName.toLowerCase()&&(u=!0,s=e.get(n[t].querySelector("filter"),"id")),i.width[t]=n[t].offsetWidth,i.height[t]=n[t].offsetHeight,i.custom[t]={isZoomed:n[t].getAttribute("data-image-zoomed"),isSvgImage:u,filterId:s,hasSvgNode:Boolean(n[t+o.SVG_REF]),imgSrc:n[t+o.IMAGE_REF].getAttribute("src"),parentId:r.id,renderedStyles:n[t].getAttribute("data-style"),hasPattern:!!n[t+o.PATTERN_REF]})},references:o,getRootWidth:function(e,t,o){return i.getRootWidth(t,o,e.getSiteWidth())},getRootLeft:function(e,t,o){return i.getRootLeft(t,o,e.getSiteX())}}}),define("layout/util/optimizedCssImageLayout",["lodash","zepto","warmupUtils"],function(e,t,i){"use strict";function o(e,t,i,o){o===n.BG_IMAGE?e.css(t,{backgroundImage:i?'url("'+i+'")':""}):e.attr(t,{src:i})}var n=i.mediaConsts.balataConsts;return{cacheCssImageMeasureData:function(i,o){var n=t(o);i.type=n.data("type"),i.currentCss=n.data("image-css"),i.currentCss&&e.isString(i.currentCss)&&(i.currentCss=JSON.parse(i.currentCss)),i.previousBackgroundImageCssUrl=n.css("backgroundImage")},patchCssImage:function(t,n,a,r,s,u){if(l=t.currentCss,(g=r)&&(!l||e.some(g,function(e,t){return e!==l[t]}))){a.css(n,r);var c=e.defaults(r,t.currentCss);a.data(n,{"image-css":JSON.stringify(c)})}var l,g,d,h,p=(d=s,h=u,d?i.urlUtils.isExternalUrl(d)?d:i.urlUtils.joinURL(h.getStaticMediaUrl(),d):"");m=t.previousBackgroundImageCssUrl,f=p,e.includes(m,f)&&Boolean(m)===Boolean(f)||function(t,i,n,a,r){var s=n.previousBackgroundImageCssUrl;r.imageResizeHandlers=r.imageResizeHandlers||{},s&&a?(r.imageResizeHandlers[t]||(r.imageResizeHandlers[t]=e.debounce(o,250,{trailing:!0})),r.imageResizeHandlers[t](i,t,a,n.type)):o(i,t,a,n.type)}(n,a,t,p,u);var m,f}}}),define("layout/bi/events.json",[],function(){return{IMAGE_UPSCALING:{eventId:348,adapter:"ugc-viewer",params:{ow:"originalWidth",oh:"originalHeight",tw:"targetWidth",th:"targetHeight",dpr:"devicePixelRatio",url:"url"}}}}),define("layout/specificComponents/imageLayout",["lodash","zepto","imageClientLib","warmupUtils","layout/bi/events.json","layout/util/rootLayoutUtils","layout/util/layout"],function(e,t,i,o,n,a,r){"use strict";function s(e,t,n){return o.imageUtils.getImageComputedProperties(i,e,t.getMediaFullStaticUrl.bind(t),t.currentUrl,t.mobile.getDevicePixelRatio(),n)}function u(t,i,o,n,a){var r,s=(r=i,e.pickBy(r,function(e){return""!==e})),u=t.css.container,c=e.assign({position:"absolute",width:o,height:n},u,s);return e.isNumber(a)&&(c.opacity=a),c}function c(t,i,o,a,r,c,l){var d,p=(d=o.custom[t].renderedStyles,d&&d.split?d.split(";").reduce(function(e,t){var i=t.split(":");return i[0]&&i[1]&&(e[i[0].trim()]=i[1].trim()),e},{}):{}),m=o.custom[t]&&o.custom[t].isZoomed;c=c||{width:o.width[t],height:o.height[t]};var f={imageData:r,containerWidth:m?r.width:c.width,containerHeight:m?r.height:c.height,displayMode:r.displayMode,alignType:l},y=void 0;o.custom[t].isSvgImage?function(t,i,o,n,a,r){var s=o.custom[t]&&o.custom[t].isSvgImage,u=o.custom[t]&&o.custom[t].filterId,c=n.containerWidth,l=n.containerHeight;if(!n.containerWidth||!n.containerHeight||!n.imageData.uri)return null;i.css(t+g.SVG_REF,{width:c,height:l}),s&&(i.attr(t+g.SVG_REF,r.attr.container),i.attrNS(t+g.IMAGE_REF,[{ns:"http://www.w3.org/1999/xlink",attribute:"xlink:href",value:r.uri}]),o.custom[t].hasPattern?(i.attr(t+g.RECT_REF,{filter:"url(#"+u+")",width:r.attr.container.width,height:r.attr.container.height,x:0,y:0}),i.attr(t+g.PATTERN_REF,r.attr.img),i.attr(t+g.IMAGE_REF,{width:r.attr.img.width,height:r.attr.img.height})):i.attr(t+g.IMAGE_REF,e.assign({filter:"url(#"+u+")"},r.attr.img)))}(t,i,o,f,0,y=s(f,a,"svg")):(y=s(f,a,"img"),w=t,v=y,i.css(w+g.IMAGE_REF,e.get(v,["css","img"])));var w,v,C=u(y,p,c.width,c.height,r.opacity);i.css(t,C);var M={patchers:i,id:t,isSvg:o.custom[t].isSvgImage,src:e.get(y,"uri"),
absoluteTop:o.absoluteTop[o.custom[t].parentId]||0,height:c.height||o.height[t],currentSrc:o.custom[t].imgSrc};I=f,b=M,T=y,(S=a).isViewerMode()&&T.uri!==b.currentSrc&&e.includes(T.uri,"lg_1")&&h(S,n.IMAGE_UPSCALING,{originalWidth:I.imageData.width,originalHeight:I.imageData.height,targetWidth:Math.round(I.containerWidth),targetHeight:Math.round(I.containerHeight),devicePixelRatio:Math.floor(100*S.mobile.getDevicePixelRatio()),url:b.src});var S,I,b,T;a.imageLoader.loadImage(M,a)}function l(i,o,n,a,r){var s=o[i].querySelectorAll("*[data-image-info]"),u=[],l={};return e.forEach(s,function(e){var i=e.getAttribute("id");o[i]=e,l[i]=t(o[i]).data("imageInfo"),d(i,n,o,a,r),u.push(i)}),function(t){e.forEach(u,function(e){var i=l[e];c(e,t,n,a,i.imageData,null,i.alignType)})}}var g=a.references,d=a.measureNodeImage,h=o.loggingUtils.logger.reportBI;return r.registerCustomMeasure("core.components.Image",d),r.registerCustomLayoutFunction("wysiwyg.viewer.components.LinkBar",l),r.registerCustomLayoutFunction("wysiwyg.viewer.components.FlashComponent",l),{patchNodeImage:c,measureNodeImage:d}}),define("layout/specificComponents/bgImageLayout",["lodash","layout/util/layout","warmupUtils","layout/util/optimizedCssImageLayout","layout/specificComponents/imageLayout"],function(e,t,i,o,n){"use strict";function a(t,o,n,a,r,s){var u=r.mobile.getDevicePixelRatio(),c={width:a.width,height:a.height,alignment:o,htmlTag:s||"bg",pixelAspectRatio:u},l={id:n.uri,width:n.width,height:n.height},g=e.defaults({quality:85},n.quality||{});return i.imageClientApi.getData(t,l,c,g,r.browser)}function r(e){var t=e.mediaRef;return t&&"WixVideo"===t.type&&(t=t.posterImageRef),t}var s=i.mediaConsts.balataConsts;return t.registerRequestToMeasureChildren("wysiwyg.viewer.components.background.bgImage",[["image"]]),t.registerRequestToMeasureChildren("wysiwyg.viewer.components.BgImageStrip",[["bg"]]),{measureLegacyBgImageStrip:function(e,t,i){var n=e+"bg";i[n]&&(t.custom[e]={},o.cacheCssImageMeasureData(t.custom[e],i[n]))},measureBgImageBalata:function(e,t,i,a,r){var u=e+s.MEDIA+s.CONTENT,c=i[u].getAttribute("data-type");if(t.custom[e]=t.custom[e]||{},t.custom[e].type=c,c===s.IMAGE)n.measureNodeImage(u,t,i,a,r);else{var l=u+"image";i[l]=i[u].querySelector("#"+l);var g=i[l];t.custom[u]={},o.cacheCssImageMeasureData(t.custom[u],g)}},patchBgImage:function(t,i,u,c,l,g,d,h){var p,m=c.custom[t].type,f=(p=l,e.isUndefined(p.designDataItem)?p.dataItem.background:p.designDataItem.background);if(m===s.IMAGE){var y={width:h.width,height:d},w=e.assign({displayMode:f.fittingType},r(f));n.patchNodeImage(i,u,c,g,w,y,f.alignType)}else{var v=i+"image",C=function(e,t,i,o,n){var s=i.width,u=o||i.height,c=r(e);return a(e.fittingType,e.alignType,c,{width:s,height:u},n,"bg")}(f,0,h,d,g),M=e.assign({height:d},C.css.container);o.patchCssImage(c.custom[i],v,u,M,C.uri,g)}},patchLegacyBgImageStrip:function(e,t,n,r,s,u){var c=n.custom[e],l=e+"bg";if(c){var g=r.dataItem;if(!g||!(h=g.uri)||i.urlUtils.isExternalUrl(h))return;var d=a(r.propertiesItem.fittingType,r.propertiesItem.alignType,g,u,s);o.patchCssImage(c,l,t,d.css.container,d.uri,s)}var h}}}),define("layout/specificComponents/html5VideoLayout",["lodash","warmupUtils","imageClientLib","layout/specificComponents/imageLayout"],function(e,t,i,o){"use strict";function n(t,o,n,a,r){var u={position:"absolute",minWidth:0,minHeight:0,top:0,left:0},c=t.mediaRef;if(!c||"WixVideo"!==c.type)return u;var l,g,d,h,p=e.find(c.qualities,{quality:a}),m=(l=o.width,g=o.height,d=p.width,h=p.height,{wScale:l/d,hScale:g/h}),f=function(e,t,o,n){var a=void 0,r=void 0,s=void 0,u=i.fittingTypes;switch(e){case u.SCALE_TO_FILL:s=Math.max(t.wScale,t.hScale),a=Math.round(o*s),r=Math.round(n*s);break;case u.SCALE_TO_FIT:s=Math.min(t.wScale,t.hScale),a=Math.round(o*s),r=Math.round(n*s)}return{width:a,height:r}}(t.fittingType,m,p.width,p.height),y=function(e,t,o){var n=o.width,a=o.compRootHeight,r=Math.round((a-t.height)/2),s=Math.round((n-t.width)/2),u={},c=i.alignTypes;switch(e){case c.CENTER:u.left=s,u.top=r;break;case c.LEFT:u.left=0,u.top=r;break;case c.RIGHT:u.left=n-t.width,u.top=r;break;case c.TOP:u.left=s,u.top=0;break;case c.BOTTOM:u.left=s,u.top=a-t.height;break;case c.TOP_LEFT:u.left=0,u.top=0;break;case c.TOP_RIGHT:u.left=n-t.width,u.top=0;break;case c.BOTTOM_LEFT:u.left=0,u.top=a-t.height;break;case c.BOTTOM_RIGHT:u.left=n-t.width,u.top=a-t.height}return u}(t.alignType,f,o);return u={position:"absolute",minWidth:f.width,minHeight:f.height,left:y.left,top:s.isFullScreenByEffect(r,n.renderFlags.renderFixedPositionBackgrounds)?"":y.top}}function a(e){return e.designDataItem&&e.designDataItem.background?e.designDataItem.background:e.dataItem.background}function r(t){var i=a(t);return!e.isEmpty(i.mediaRef.qualities)}var s=t.containerBackgroundUtils,u=t.mediaConsts.balataConsts;return{patchBgVideo:function(t,i,u,c,l,g,d){var h=a(c),p=d.width,m=d.height,f={width:p,height:g,top:0},y=e.assign({displayMode:h.fittingType},h.mediaRef.posterImageRef);o.patchNodeImage(t+"poster",i,u,l,y,f,h.alignType);var w=u.custom[t];if(r(c)){var v=!l.isTouchDevice(),C=s.getBgEffectName(c.behaviorsItem,v,l.isMobileView()),M=n(h,{width:p,height:g,compRootHeight:m},l,w.quality,C);i.attr(t+"video",{width:M.minWidth,height:M.minHeight}),i.css(t+"video",M)}else i.css(t+"poster",{position:"absolute",top:"0px"}),i.attr(t+"video",{src:""}),w.videoNode.load()},measureBgVideo:function(e,t,i,n,a){var s=e+u.POSTER;t.custom[s]={},o.measureNodeImage(s,t,i,n,a);var c=i[e],l=c.firstChild;i[e+"video"]=l,t.custom[e]={},r(a)?t.custom[e]={quality:c.getAttribute("data-quality"),videoNode:l}:t.custom[e]={videoNode:l}}}}),define("layout/specificComponents/youtubeVideoLayout",["lodash","warmupUtils","layout/specificComponents/imageLayout"],function(e,t,i){"use strict";var o=t.mediaConsts.balataConsts;return{patchBgVideo:function(t,o,n,a,r,s,u){var c,l=(c=a,c.designDataItem&&c.designDataItem.background?c.designDataItem.background:c.dataItem.background),g=u.width,d=u.height;o.attr(t+"video",{"min-width":g,"min-height":d,width:g,height:d}),o.css(t+"video",{position:"absolute"});var h={width:g,height:s,top:0},p=l.mediaRef.posterImage||{uri:"//img.youtube.com/vi/"+l.mediaRef.videoId+"/hqdefault.jpg"},m=e.assign({displayMode:l.fittingType},p);i.patchNodeImage(t+"poster",o,n,r,m,h,l.alignType)},measureBgVideo:function(e,t,n,a,r){var s=e+o.POSTER,u=n[e];n[e+"video"]=u.firstChild,t.custom[e]={},t.custom[s]={},i.measureNodeImage(s,t,n,a,r)}}}),define("layout/specificComponents/balataLayout",["lodash","warmupUtils","layout/specificComponents/bgImageLayout","layout/specificComponents/html5VideoLayout","layout/specificComponents/youtubeVideoLayout"],function(e,t,i,o,n){"use strict";function a(e){var t=e+u,i=t+c;return{balataId:t,mediaId:i,mediaContentId:i+l}}function r(t,r,s,u,c,l){var g=a(t),d=g.balataId,h=g.mediaContentId,p=!!s[d];if(p){var m,f,y,w,v=s[d].dataset,C=v.enableVideo,M=v.bgEffectName,S=v.mediaType,I=v.mediaVideoType,b=v.renderFixedPosition,T=v.useClipPath,A=v.pageId,L=s[A]?s[A].getBoundingClientRect().left:0,E=l||(m=r,f=s[d],y=t,w=L,{top:0,left:0,height:e.defaultTo(m.height[y],f.offsetHeight),width:f.offsetWidth,absoluteLeft:f.getBoundingClientRect().left-w});r.custom[d]={hasBalata:p,enableVideo:C,bgEffectName:M,mediaType:S,mediaVideoType:I,renderFixedPosition:b,useClipPath:T,pageId:A},e.forEach(E,function(e,t){r[t][d]=e}),S&&("Image"!==S&&C?"WixVideo"===S?o.measureBgVideo(h,r,s,u,c):"Video"===S&&"YOUTUBE"===I&&n.measureBgVideo(h,r,s,u,c):i.measureBgImageBalata(d,r,s,u,c))}}var s=t.mediaConsts.balataConsts,u=s.BALATA,c=s.MEDIA,l=s.CONTENT,g=s.OVERLAY,d=s.POSTER,h=t.containerBackgroundUtils;return{BALATA_PATHS_TO_REQUEST_MEASURE:[[u],[u,c],[u,c,l],[u,c,l,d],[u,g],[u,g,g]],measure:r,measureDomOnly:function(e,t,i,o,n){var s=a(e).balataId,u=i[s].dataset.pageId;r(e,t,i,o,n,(c=i[s],l=i[u],{top:0,left:0,width:c.offsetWidth,height:c.offsetHeight,absoluteLeft:c.getBoundingClientRect().left-l.getBoundingClientRect().left}));var c,l},patch:function(t,r,s,u,c,l){var g=a(t),d=g.balataId,p=g.mediaId,m=g.mediaContentId,f=s.custom[d]||{},y=f.hasBalata,w=f.enableVideo,v=f.bgEffectName,C=f.mediaType,M=f.mediaVideoType,S=f.renderFixedPosition,I=f.useClipPath;if(y){var b,T,A=l||(b=s,T=d,{top:b.top[T],left:b.left[T],width:b.width[T],height:b.height[T],absoluteLeft:b.absoluteLeft[T]});l||(A.height=e.defaultTo(s.height[t],A.height));var L=h.getHeightByEffect(v,s,A.height),E=function(e,t){var i={};return t?i["-webkit-clip-path"]="border-box":i.clip="rect(0px,"+e.width+"px,"+e.height+"px,0px)",i}(A,I);if(r.css(d,E),C){r.css(p,{width:A.width,height:L,left:(x=v,P=S,D=A.absoluteLeft||0,h.isFullScreenByEffect(x,!!P)?Math.floor(D):0)});var x,P,D;"Image"!==C&&w?"WixVideo"===C?o.patchBgVideo(m,r,s,u,c,L,A):"Video"===C&&"YOUTUBE"===M&&n.patchBgVideo(m,r,s,u,c,L,A):i.patchBgImage(d,m,r,s,u,c,L,A)}}}}}),define("layout/specificComponents/screenWidthLayouts/screenWidthContainerLayout",["layout/util/layout"],function(e){"use strict";function t(e,t,o){t.left[e]=0,i(e,t,o)}function i(e,t,i){var o=t.height[e+"inlineContent"]||0;t.containerHeightMargin[e]=o?i[e].offsetHeight-o:0}var o="mobile.core.components.Container";return e.registerRequestToMeasureDom(o),e.registerRequestToMeasureChildren(o,[["inlineContent"]]),e.registerCustomMeasure(o,i),e.registerCustomMeasure("wysiwyg.viewer.components.ScreenWidthContainer",t),{measureContainer:i,measureScreenWidthContainer:t}}),define("layout/specificComponents/matrixGalleryLayout",["layout/util/layout","zepto","lodash","warmupUtils","imageClientLib","layout/specificComponents/imageLayout"],function(e,t,i,o,n,a){"use strict";function r(e,o,a,r,s,u,c){var h,p,m,f,y,w=t(u),v=w.data("image-index"),C=i.defaults({displayMode:n.fittingTypes.SCALE_TO_FILL},s[v]),M=(h=C,p=a,m=o,f=r,y=w,d.getSizeAfterScaling({itemHeight:p,itemWidth:m,displayerData:h,imageMode:f.imageMode,heightDiff:parseInt(y.data("height-diff"),10)||0,widthDiff:parseInt(y.data("width-diff"),10)||0,bottomGap:parseInt(y.data("bottom-gap"),10)||0})),S=g.getContainerSize(M.imageWrapperSize,w),I=l.getItemPosition(c,o,a,r.margin,r.numCols);return{id:u.id,imageData:C,imageNodeId:u.id+"image",imageWrapperId:u.id+"imageWrapper",containerSize:S,sizeAfterScaling:M,position:I}}function s(e,o,n,a,s){g.measureFlexibleHeightGallery(e,o,n);var u=t(n[e]),c=n[e+"itemsContainer"],d=t(c).children(),m=s.dataItem.items;o.width[e]=Math.max(p,o.width[e]),o.height[e]=Math.max(h,o.height[e]);var f=parseInt(u.data("height-diff"),10)||0,y=parseInt(u.data("width-diff"),10)||0,w=parseInt(u.data("presented-row"),10)||0,v=s.propertiesItem,C=l.getItemWidth(v.margin,v.numCols,o.width[e],y),M=l.getItemHeight(v.margin,o.height[e],w,f);o.custom[e]={itemsContainer:{height:o.height[e]-f},showMore:{height:i.get(n[e+"showMore"],"offsetHeight",0)},displayers:i.map(d,i.partial(r,e,C,M,s.propertiesItem,m))}}function u(e,t,o,n,r){var s=o.custom[e];i.forEach(s.displayers,function(e){var i=e.sizeAfterScaling;t.css(e.id,{height:i.displayerSize.height,width:i.displayerSize.width,left:e.position.left,top:e.position.top}),g.updateImageWrapperSizes(t,e.imageWrapperId,i),a.patchNodeImage(e.imageNodeId,t,o,r,e.imageData,e.containerSize)})}function c(e,t,o){var n=[["showMore"],["itemsContainer"]];return i.forEach(o.dataItem.items,function(e){var t={pathArray:[e.id,"image"],type:"core.components.Image"},i=[e.id,"imageWrapper"],o=[e.id];n.push(t,i,o)}),n}var l=o.matrixCalculations,g=o.galleriesCommonLayout,d=o.matrixScalingCalculations,h=70,p=45;return e.registerRequestToMeasureDom("wysiwyg.viewer.components.MatrixGallery"),e.registerCustomMeasure("wysiwyg.viewer.components.MatrixGallery",s),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.MatrixGallery",c),e.registerPatcher("wysiwyg.viewer.components.MatrixGallery",u),{measureMatrixGallery:s,getChildrenIdToMeasure:c,patchMatrixGallery:u}}),define("layout/specificComponents/paginatedGridGalleryLayout",["layout/util/layout","zepto","lodash","warmupUtils","imageClientLib","layout/specificComponents/imageLayout"],function(e,t,i,o,n,a){"use strict";function r(e,t,o,r,s,u,c,l,d){i.forEach(e,function(e,l){var h=g.getItemPosition(l,t,o,r.margin,r.numCols);u.css(e.imageItemId,{width:t,height:o,left:h.left,top:h.top});var p=i.assign({},d.dataItem.items[e.imageIndex],{displayMode:n.fittingTypes.SCALE_TO_FILL});a.patchNodeImage(e.imageItemId,u,c,s,p,{width:t,height:o})})}function s(e,t,o){var n=[["itemsContainer"]];return i.forEach(o.dataItem.items,function(e){n.push({pathArray:[e.id],type:"core.components.Image"})}),n}function u(e){return i.map(e,function(e){return{imageItemId:e.id,imageIndex:t(e).data("image-index")}})}function c(e,i,o){var n=i.custom[e]={},a=t(o[e]);n.heightDiff=parseInt(a.data("height-diff"),10),n.widthDiff=parseInt(a.data("width-diff"),10);var r=t(o[e+"itemsContainer"]);n.nextItemsData=u(r.children('div[data-page-desc="next"]')),n.prevItemsData=u(r.children('div[data-page-desc="prev"]')),n.currItemsData=u(r.children('div[data-page-desc="curr"]'))}function l(e,t,i,o,n){var a=i.height[e],s=i.width[e],u=i.custom[e],c=o.propertiesItem;t.css(e+"itemsContainer",{width:s-u.widthDiff,height:a-u.heightDiff});var l=g.getItemWidth(c.margin,c.numCols,s,u.widthDiff),d=g.getAvailableRowsNumber(c.maxRows,c.numCols,o.dataItem.items.length),h=g.getItemHeight(c.margin,a,d,u.heightDiff);r(u.nextItemsData,l,h,c,n,t,i,0,o),r(u.prevItemsData,l,h,c,n,t,i,0,o),r(u.currItemsData,l,h,c,n,t,i,0,o)}var g=o.matrixCalculations;return e.registerPatcher("wysiwyg.viewer.components.PaginatedGridGallery",l),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.PaginatedGridGallery",s),e.registerCustomMeasure("wysiwyg.viewer.components.PaginatedGridGallery",c),{patchPaginatedGridGallery:l,getChildrenIdToMeasure:s,customMeasurePaginatedGridGalleryLayout:c}}),define("layout/specificComponents/richtextLayout",["lodash","layout/util/layout"],function(e,t){"use strict";function i(t,i,o){var n=o[t],a=e.has(n.dataset,"minHeight")?e.toNumber(n.dataset.minHeight):void 0,r="true"===n.dataset.packed,s=n.offsetHeight,u=Math.max(a||0,s);i.minHeight[t]=u,!r&&e.isUndefined(a)||(i.height[t]=u)}function o(e,t){t.css(e,{height:""})}var n="wysiwyg.viewer.components.WRichText";return t.registerRequestToMeasureDom(n),t.registerCustomMeasure(n,i),t.registerPatcher(n,o),{richTextCompName:n,measureWRichText:i,patchWRichText:o}}),define("layout/specificComponents/slideShowLayout",["layout/util/layout","zepto","warmupUtils","imageClientLib","lodash","layout/specificComponents/imageLayout"],function(e,t,i,o,n,a){"use strict";function r(e,i,a,r,s,u){var c=t(u),d=c.data("image-index"),h=n.defaults({displayMode:o.fittingTypes.SCALE_TO_FILL},s[d]),p=function(e,i,o,n,a){var r=t(a);return l.getSizeAfterScaling({itemHeight:i,itemWidth:o,displayerData:e,imageMode:n.imageMode,heightDiff:parseInt(r.data("height-diff"),10)||0,widthDiff:parseInt(r.data("width-diff"),10)||0,bottomGap:parseInt(r.data("bottom-gap"),10)||0})}(h,i,a,r,c),m=g.getContainerSize(p.imageWrapperSize,c);return{id:u.id,imageData:h,imageNodeId:u.id+"image",imageWrapperId:u.id+"imageWrapper",containerSize:m,sizeAfterScaling:p}}function s(e,i,o,a,s){g.measureFlexibleHeightGallery(e,i,o);var u=o[e+"itemsContainer"],c=t(u).children(),l=t(o[e]),d=i.height[e]-parseInt(l.data("height-diff"),10)||0,h=i.width[e]-parseInt(l.data("height-diff"),10)||0,p=s.dataItem.items;i.custom[e]={displayers:n.map(c,n.partial(r,e,d,h,s.propertiesItem,p))}}function u(e,t,i,o,r){var s=o.propertiesItem,u=i.height[e],c=i.width[e],l=r.isMobileDevice()||r.isMobileView(),d=i.custom[e].displayers;if(!n.isEmpty(d)){if("flexibleHeight"===s.imageMode){var h=n.last(d);u=h.sizeAfterScaling.displayerSize.height}t.css(e,{height:u,width:c}),n.forEach(d,function(e){t.css(e.id,{height:u,width:c}),g.updateImageWrapperSizes(t,e.imageWrapperId,e.sizeAfterScaling),a.patchNodeImage(e.imageNodeId,t,i,r,e.imageData,e.containerSize,l)})}}function c(e,t,i){var o=[["itemsContainer"]];return n.forEach(i.dataItem.items,function(e){var t={pathArray:[e.id,"image"],type:"core.components.Image"},i=[e.id,"imageWrapper"],n=[e.id];o.push(t,i,n)}),o}var l=i.matrixScalingCalculations,g=i.galleriesCommonLayout;return e.registerRequestToMeasureDom("wysiwyg.viewer.components.SlideShowGallery"),e.registerCustomMeasure("wysiwyg.viewer.components.SlideShowGallery",s),e.registerRequestToMeasureChildren("wysiwyg.viewer.components.SlideShowGallery",c),e.registerPatcher("wysiwyg.viewer.components.SlideShowGallery",u),{measureSlideShow:s,getChildrenIdToMeasure:c,patchSlideShow:u}}),define("layout/specificComponents/sliderGalleryLayout",["layout/util/layout","warmupUtils","imageClientLib","zepto","lodash","layout/specificComponents/imageLayout"],function(e,t,i,o,n,a){"use strict";function r(e,t,a,r,s,u,c){var d=o(u),h={imageIndex:d.data("image-index"),width:d.data("displayer-width"),height:d.data("displayer-height"),uri:d.data("displayer-uri")},p={heightDiff:parseInt(d.data("height-diff"),10)||0,widthDiff:parseInt(d.data("width-diff"),10)||0,bottomGap:parseInt(d.data("bottom-gap"),10)||0},m=s&&s[h.imageIndex]?s[h.imageIndex]:h,f=function(e,t,i,o,n){var a=Math.floor(t+e);return l.getSizeAfterScaling({itemHeight:a,itemWidth:Math.floor(a*(n&&n.aspectRatio?n.aspectRatio:1)),displayerData:i,imageMode:n?n.imageMode:"clipImage",heightDiff:o.heightDiff,widthDiff:o.widthDiff,bottomGap:o.bottomGap})}(a,t,m=n.assign(m,{displayMode:i.fittingTypes.SCALE_TO_FILL}),p,r.propertiesItem);return{imageData:m,imageNodeId:e+"displayer"+c+"image",imageWrapperId:e+"displayer"+c+"imageWrapper",containerSize:g.getContainerSize(f.imageWrapperSize,d),sizeAfterScaling:f}}function s(e,t,i,a,s){var u=i[e+"images"],c=o(u).children(),l=n.get(s,"dataItem.items"),g=parseInt(o(i[e]).data("additional-height"),10)||0;t.custom[e]={displayers:n.map(c,n.partial(r,e,t.height[e],g,s,l)),additionalHeight:g}}function u(e,t,i,o,r){var s=i.height[e];t.css(e,{height:s});var u=i.custom[e];n.forEach(u.displayers,function(e){g.updateImageWrapperSizes(t,e.imageWrapperId,e.sizeAfterScaling),a.patchNodeImage(e.imageNodeId,t,i,r,e.imageData,e.containerSize)})}function c(e){var t=[["images"],["itemsContainer"]],i=o("#"+e+"images").children();return n.forEach(i,function(e,i){var o="displayer"+i,n={pathArray:[o,"image"],type:"core.components.Image"},a=[o,"imageWrapper"];t.push(n,a)}),t}var l=t.matrixScalingCalculations,g=t.galleriesCommonLayout;return e.registerRequestToMeasureChildren("wysiwyg.viewer.components.SliderGallery",c),e.registerCustomMeasure("wysiwyg.viewer.components.SliderGallery",s),e.registerPatcher("wysiwyg.viewer.components.SliderGallery",u),{getChildrenIdToMeasure:c,measureSliderGalleryLayout:s,patchSliderGalleryLayout:u}}),define("layout/specificComponents/wPhotoLayout",["zepto","lodash","layout/util/layout","layout/specificComponents/imageLayout","imageClientLib","warmupUtils"],function(e,t,i,o,n,a){"use strict";function r(t,i,o){var n=e(o[t]),a=parseInt(n.data("content-padding-horizontal"),10),r=parseInt(n.data("content-padding-vertical"),10),s=parseFloat(n.data("exact-height"));i.height[t]=i.custom[t]&&i.custom[t].thisIsMyHeight||o[t].offsetHeight,i.custom[t]={marginWidth:a,marginHeight:r,exactHeight:s}}function s(e,i,r,s,c){var l,g=e+"img",d=e+"link",h=s.dataItem,p=s.propertiesItem,m=p&&p.displayMode||"fill",f=(l=m,l===n.fittingTypes.LEGACY_FIT_WIDTH?n.fittingTypes.LEGACY_FIT_HEIGHT:u[l]||l),y=a.imageUtils.getContainerSize(n,function(e,t,i){var o=t.height[e]-(t.custom[e].marginHeight||0),a=t.width[e]-(t.custom[e].marginWidth||0),r={width:a>0?a:t.width[e],height:o>0?o:t.height[e]},s=t.custom[e].exactHeight-(t.custom[e].marginHeight||0);return i===n.fittingTypes.LEGACY_FIT_HEIGHT&&Math.ceil(s)===r.height&&(r.height=s),r}(e,r,f),{width:h.width,height:h.height},f),w=a.layoutUtils.isVerticallyStretched(s.layout),v={width:a.layoutUtils.isHorizontallyStretched(s.layout)?"":y.width+r.custom[e].marginWidth,height:w?"":y.height+r.custom[e].marginHeight},C=t.assign({},t.pick(h,["width","height","uri","quality","upscaleMethod"]),{displayMode:f,crop:t.get(p,"overrideCrop")||h.crop});o.patchNodeImage(g,i,r,c,C,y),i.css(e,v),i.css(d,y)}var u={fitWidthStrict:n.fittingTypes.LEGACY_FIT_WIDTH,fitHeightStrict:n.fittingTypes.LEGACY_FIT_HEIGHT},c={pathArray:["img"],type:"core.components.Image"};return i.registerRequestToMeasureDom("wysiwyg.viewer.components.WPhoto"),i.registerRequestToMeasureChildren("wysiwyg.viewer.components.WPhoto",[c,["link"]]),i.registerPatcher("wysiwyg.viewer.components.WPhoto",s),i.registerCustomMeasure("wysiwyg.viewer.components.WPhoto",r),i.registerRequestToMeasureDom("wysiwyg.viewer.components.ClipArt"),i.registerRequestToMeasureChildren("wysiwyg.viewer.components.ClipArt",[c,["link"]]),i.registerPatcher("wysiwyg.viewer.components.ClipArt",s),i.registerCustomMeasure("wysiwyg.viewer.components.ClipArt",r),{childImageComponent:c,patchNodePhoto:s,measurePhoto:r}}),define("layout/specificComponents/fiveGridLineLayout",["lodash","layout/util/layout"],function(e,t){"use strict";t.registerPatcher("wysiwyg.viewer.components.FiveGridLine",function(t,i,o,n){e.get(n,"propertiesItem.fullScreenModeOn")&&i.css(t,{width:"100%",left:0,marginLeft:0})}),t.registerRequestToMeasureChildren("wysiwyg.viewer.components.FiveGridLine",[["line"]]),t.registerRequestToMeasureDom("wysiwyg.viewer.components.FiveGridLine"),t.registerCustomMeasure("wysiwyg.viewer.components.FiveGridLine",function(e,t,i){var o=t.height[e+"line"],n=window.getComputedStyle(i[e]),a=parseFloat(n.borderBottomWidth);t.height[e]=Math.max(5,a,o),t.minHeight[e]=o})}),define("layout/specificComponents/registerToMeasureOnly",["layout/util/layout"],function(e){"use strict";return e.registerRequestToMeasureDom("wysiwyg.common.components.pinterestpinit.viewer.PinterestPinIt"),e.registerRequestToMeasureDom("wysiwyg.common.components.spotifyfollow.viewer.SpotifyFollow"),e.registerRequestToMeasureDom("wysiwyg.common.components.spotifyplayer.viewer.SpotifyPlayer"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.Video"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.WTwitterTweet"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.SoundCloudWidget"),e.registerRequestToMeasureDom("wysiwyg.common.components.disquscomments.viewer.DisqusComments"),{}}),define("layout/specificComponents/registerToPureDomMeasure",["lodash","warmupUtils","layout/util/layout"],function(e,t,i){"use strict";function o(t,o){i.registerCustomMeasure(t,function(t,i,n){var a=n[t];e.get(o,"height",!0)&&(i.height[t]=a.offsetHeight),e.get(o,"width",!0)&&(i.width[t]=a.offsetWidth)})}function n(e){i.registerAdditionalMeasureFunction(e,function(e,i,o){i.containerHeightMargin[e]=t.measurerUtils.getContainerVerticalMarginFromContent(e,o[e])},"containerHeightMargin")}o("wysiwyg.viewer.components.FlashComponent"),o("wysiwyg.common.components.pinterestpinit.viewer.PinterestPinIt"),o("wysiwyg.viewer.components.WGooglePlusOne"),o("wysiwyg.viewer.components.LinkBar"),o("wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer"),o("wysiwyg.common.components.facebooklikebox.viewer.FacebookLikeBox"),o("wysiwyg.viewer.components.PayPalButton"),o("wysiwyg.viewer.components.PinterestFollow"),o("wysiwyg.common.components.spotifyfollow.viewer.SpotifyFollow"),o("wysiwyg.viewer.components.FlickrBadgeWidget"),o("wysiwyg.viewer.components.WTwitterFollow"),o("wysiwyg.viewer.components.WTwitterTweet"),o("wysiwyg.viewer.components.LoginButton"),o("wysiwyg.viewer.components.AdminLoginButton"),o("wysiwyg.viewer.components.ItunesButton"),o("wysiwyg.viewer.components.WFacebookLike"),o("wysiwyg.viewer.components.VerticalLine",{width:!1}),o("wysiwyg.viewer.components.FlashComponent"),o("wysiwyg.viewer.components.FacebookShare"),o("wysiwyg.viewer.components.Group"),o("wysiwyg.common.components.skypecallbutton.viewer.SkypeCallButton"),o("platform.components.AppController"),o("wysiwyg.viewer.components.VKShareButton"),o("wysiwyg.common.components.youtubesubscribebutton.viewer.YouTubeSubscribeButton"),o("wysiwyg.viewer.components.inputs.RadioGroup"),o("tpa.viewer.components.Impress"),o("tpa.viewer.components.Thumbnails"),o("tpa.viewer.components.Honeycomb"),o("tpa.viewer.components.Accordion"),o("wysiwyg.viewer.components.tpapps.TPA3DGallery"),o("wysiwyg.viewer.components.LanguageSelector"),o("tpa.viewer.components.Masonry"),o("tpa.viewer.components.Freestyle"),o("wysiwyg.viewer.components.tpapps.TPA3DCarousel"),o("wysiwyg.viewer.components.inputs.TextInput"),o("wysiwyg.viewer.components.inputs.TextAreaInput"),o("mobile.core.components.Page",{height:!1}),o("wixui.Tags",{width:!1}),a="mobile.core.components.Page",i.registerAdditionalMeasureFunction(a,function(e,t,i){var o=i[e];t.minHeight[e]=parseInt(o.style.minHeight,10)},"pageMinHeight");var a;return o("wixui.Pagination"),o("wixui.RatingsDisplay"),n("wysiwyg.viewer.components.ScreenWidthContainer"),n("wysiwyg.viewer.components.HeaderContainer"),n("wysiwyg.viewer.components.FooterContainer"),n("mobile.core.components.Page"),o("tpa.viewer.components.Collage"),{}}),define("layout/specificComponents/menuLayout",["zepto","lodash","layout/util/layout","warmupUtils"],function(e,t,i,o){"use strict";function n(e){return!isNaN(parseFloat(e))&&isFinite(e)}function a(e,i,o,n,a,r,s,u,c,l){var g=o.concat("__more__"),d=i.custom[e],h=d.realWidths,p=d.menuItemContainerExtraPixels,m=i.width[e];if(t.findIndex(g,function(e){return e===n})>=0&&h){var f=Math.abs(l.getSiteX()),y=i.fixed[e]?i.absoluteLeft[e]:f+i.absoluteLeft[e],w=function(e,t,i,o,n,a,r,s,u){var c="0px",l="auto",g=a.left,d=a.width;if("left"===t?c="left"===n?0:g+e.left+"px":"right"===t?(l="right"===n?0:o-g-d-e.right+"px",c="auto"):"left"===n?c=g+(d+e.left-i)/2+"px":"right"===n?(c="auto",l=(d+e.right-(i+e.width))/2+"px"):c=e.left+g+(d-(i+e.width))/2+"px","auto"!==c){c=r+parseInt(c,10)<0?0:c}if("auto"!==l){l=s-parseInt(l,10)>u?0:l}return{moreContainerLeft:c,moreContainerRight:l}}(p,s,c,m,a,u,y,y+m,i.clientWidth);return{left:w.moreContainerLeft,right:w.moreContainerRight,bottom:d.needToOpenMenuUp?r+"px":"auto"}}}function r(e){var t=parseFloat(e);return isFinite(t)?t:0}var s=o.warmupMenuUtils,u="__more__",c="moreContainer";return i.registerPatcher("wysiwyg.viewer.components.menus.DropDownMenu",function(e,i,o,r,l){i.css(e,{"overflow-x":"visible"});var g=o.height[e],d=r.dataItem.menuRef?r.dataItem.menuRef.id:"CUSTOM_MAIN_MENU",h=s.getMenuById(d,l,!0,{},!1),p=t.keys(h),m=p.concat("__more__"),f=o.custom[e];y=e,w=i,v=f.needToOpenMenuUp,w.data(y,{dropmode:v?"dropUp":"dropDown"});var y,w,v,C=f.menuItemContainerExtraPixels,M=0;if(f.hoverState===u){var S=f.realWidths.indexOf(0),I=f.menuItems[t.findKey(f.menuItems,["menuIndex",S])],b=I.moreIndex,T=b===p.length-1;I.moreDOMid&&i.attr(I.moreDOMid,{"data-listposition":T?"dropLonely":"top"}),t(f.menuItems).filter(function(e){return!!e.moreDOMid}).forEach(function(e){if(e.moreIndex<b)i.css(e.moreDOMid,{display:"none"});else{var t=e.moreDOMid+"label";M=Math.max(o.width[t],M)}})}else f.hoverState&&t.forEach(f.moreSubItem,function(t,i){var n=e+c+i+"label";M=Math.max(o.width[n],M)});!function(e,i,o,r,l,g){var d=o.custom[e],h=d.hoverState,p=l.dataItem.menuRef?l.dataItem.menuRef.id:"CUSTOM_MAIN_MENU",m=t.keys(s.getMenuById(p,r,!0,{},!1)),f=m.indexOf(h);if(n(d.hoverState)||h===u){if(!o.custom[e].realWidths)return;var y=Math.max(g,o.width[-1!==f?e+f:e+u]),w=t.isEmpty(d.moreSubItem)?0:d.lineHeight[d.moreSubItem[0]+"label"],v=(I=w,b=d,I+15+b.menuBorderY+b.labelPad+b.menuButtonBorder);t.forEach(d.moreSubItem,function(e){i.css(e,{"min-width":y+"px"}),i.css(e+"label",{"min-width":"0px","line-height":v+"px"})});var C=n(d.hoverState)?d.hoverState:"__more__",M={width:o.width[e+C],left:o.left[e+C]},S=a(e,o,m,h,d.hoverListPosition,o.height[e],d.alignButtons,M,y,r);i.css(e+c,{left:S.left,right:S.right}),i.css(e+"dropWrapper",{left:S.left,right:S.right,bottom:S.bottom})}var I,b}(e,i,o,l,r,M),f.originalGapBetweenTextAndBtn&&t.forEach(m,function(t){f.hasOriginalGapData[t]||i.data(e+t,{originalGapBetweenTextAndBtn:f.originalGapBetweenTextAndBtn[e+t]})}),function(e,t,i,o,n,a,r){for(var s=0,u=null,c=null,l=i.custom[e].lineHeight[e],g=a-r.height,d=0;d<o.length;d++){var h=n[d],p=h>0,m=e+o[d];c=i.custom[e].linkIds[m],p?(s++,u=m,t.css(m,{width:h+"px",height:g+"px",position:"relative","box-sizing":"border-box",overflow:"visible"}),t.css(m+"label",{"line-height":l}),t.attr(m,{"aria-hidden":!1}),t.attr(c,{tabIndex:0})):(t.css(m,{height:"0px",overflow:"hidden",position:"absolute"}),t.attr(m,{"aria-hidden":!0}),t.attr(c,{tabIndex:-1}))}1===s&&(t.data(e+"moreContainer",{listposition:"lonely"}),t.data(u,{listposition:"lonely"}))}(e,i,o,m,f.realWidths,g,C)}),i.registerCustomMeasure("wysiwyg.viewer.components.menus.DropDownMenu",function(i,n,a,u,c){var l,g=e(a[i]),d=e("#"+i+"itemsContainer")[0]||a[i+"itemsContainer"],h=d.childNodes,p=a[i+"moreContainer"],m=p.childNodes,f=n.custom[i]={alignButtons:g.data("dropalign"),hoverListPosition:g.data("drophposition"),menuBorderY:parseInt(g.data("menuborder-y"),10),ribbonExtra:parseInt(g.data("ribbon-extra"),10),ribbonEls:parseInt(g.data("ribbon-els"),10),labelPad:parseInt(g.data("label-pad"),10),menuButtonBorder:parseInt(g.data("menubtn-border"),10),menuItemContainerMargins:function(t){var i=t.lastChild;return(parseInt(e(i).css("margin-left"),10)||0)+(parseInt(e(i).css("margin-right"),10)||0)}(d),menuItemContainerExtraPixels:function(t,i){var o=e(t).css(["border-top-width","border-bottom-width","border-left-width","border-right-width","padding-top","padding-bottom","padding-left","padding-right","margin-top","margin-bottom","margin-left","margin-right"]),n=r(o["border-top-width"])+r(o["padding-top"]),a=r(o["border-bottom-width"])+r(o["padding-bottom"]),s=r(o["border-left-width"])+r(o["padding-left"]),u=r(o["border-right-width"])+r(o["padding-right"]);return n+=r(o["margin-top"]),a+=r(o["margin-bottom"]),s+=r(o["margin-left"]),u+=r(o["margin-right"]),{top:n,bottom:a,left:s,right:u,height:n+a,width:s+u}}(d),needToOpenMenuUp:(l=a[i],l.getBoundingClientRect().top>window.innerHeight/2),menuItemMarginForAllChildren:!c.propertiesItem.stretchButtonsToMenuWidth||"false"!==d.getAttribute("data-marginAllChildren")};f.moreSubItem=[],f.lineHeight={},f.labelWidths={},f.linkIds={},f.parentId={},f.menuItems={},t.forEach(m,function(t,i){var o=e(t);f.parentId[t.id]=o.data("parent-id");var r=o.data("data-id");f.menuItems[r]={dataId:r,parentId:o.data("parent-id"),moreDOMid:t.id,moreIndex:i},a[t.id]=t;var s=e(t).find("p")[0];a[s.id]=s,n.width[s.id]=s.offsetWidth,n.height[s.id]=s.offsetHeight,n.left[s.id]=s.offsetLeft,f.lineHeight[s.id]=parseInt(window.getComputedStyle(s).fontSize,10),f.moreSubItem.push(t.id)}),t.forEach(h,function(t,i){var o=e(t).data("data-id");f.menuItems[o]=f.menuItems[o]||{},f.menuItems[o].menuIndex=i,f.menuItems[o].menuDOMid=t.id,n.left[t.id]=t.offsetLeft;var r=e(t).find("p")[0];a[r.id]=r,f.labelWidths[r.id]=function(e){var t=window.getComputedStyle(e);return parseInt(t.width,10)+parseInt(t.paddingLeft,10)+parseInt(t.paddingRight,10)}(r);var s=e(t).find("a")[0];a[s.id]=s,f.linkIds[t.id]=s.id});var y=n.height[i];f.lineHeight[i]=(w=y,v=f,o.style.unitize(w-v.menuBorderY-v.labelPad-v.ribbonEls-v.menuButtonBorder-v.ribbonExtra));var w,v,C=c.dataItem.menuRef?c.dataItem.menuRef.id:"CUSTOM_MAIN_MENU",M=t.keys(s.getMenuById(C,u,!0,{},!1)).concat("__more__"),S=function(i,o,n,a,r){var u=o.width[i],c=o.custom[i];c.hasOriginalGapData={},c.originalGapBetweenTextAndBtn={};var l=t.map(r,function(n){var r=void 0,s=e(a[i+n]).data("originalGapBetweenTextAndBtn");return t.isUndefined(s)?(c.hasOriginalGapData[n]=!1,r=o.width[i+n]-c.labelWidths[i+n+"label"],c.originalGapBetweenTextAndBtn[i+n]=r):(c.hasOriginalGapData[n]=!0,r=parseInt(s,10)),o.width[i+n]>0?c.labelWidths[i+n+"label"]+r:0}),g=l.pop(),d=n.sameWidthButtons,h=n.stretchButtonsToMenuWidth,p=!1,m=c.menuItemContainerMargins,f=c.menuItemMarginForAllChildren,y=c.menuItemContainerExtraPixels,w=s.getMaxWidth(l),v=s.getDropDownWidthIfOk(u,d,h,l,m,w,f,y);if(!v){
for(var C=1;C<=l.length;C++)if(v=s.getDropDownWidthIfOk(u,d,h,l.slice(0,-1*C).concat(g),m,w,f,y)){p=!0;break}v||(p=!0,v=[g])}if(p){var M=v[v.length-1];for(v=v.slice(0,-1);v.length<r.length;)v.push(0);v[v.length-1]=M}return{realWidths:v,moreShown:p}}(i,n,c.propertiesItem,a,M);f.realWidths=S.realWidths,f.isMoreShown=S.moreShown,f.hoverState=p.getAttribute("data-hover")}),i.registerRequestToMeasureChildren("wysiwyg.viewer.components.menus.DropDownMenu",function(e,i,o,n){var a=o.dataItem.menuRef?o.dataItem.menuRef.id:"CUSTOM_MAIN_MENU",r=t.keys(s.getMenuById(a,n,!0,{},!1)).concat("__more__"),u=[["moreContainer"],["itemsContainer"],["dropWrapper"]];return t.forEach([[]],function(e){u=u.concat(t.map(r,function(t){return[t].concat(e)}))}),u}),{}}),define("layout/specificComponents/verticalMenuLayout",["lodash","layout/util/layout"],function(e,t){"use strict";function i(e,t,i){var o,n,a=e.custom[t],r=e.absoluteTop[t]-a.pageYOffset,s="subMenuOpenDir-"+(o=a.screenHeight,n=r,Math.floor(o/2)>n?"down":"up");i.attr(t,{"data-open-direction":s})}return t.registerRequestToMeasureChildren("wysiwyg.common.components.verticalmenu.viewer.VerticalMenu",[["menuContainer"]]),t.registerCustomMeasure("wysiwyg.common.components.verticalmenu.viewer.VerticalMenu",function(e,t,i,o){o.isMobileView()?(t.height[e+"menuContainer"]=t.height[e],t.width[e+"menuContainer"]=t.width[e]):function(e,t,i){var o=e+"menuContainer";i[o]&&(t.custom[e]={screenHeight:t.height.screen,pageYOffset:window.pageYOffset},t.width[e]=i[o].offsetWidth,t.height[e]=i[o].offsetHeight)}(e,t,i)}),t.registerPatcher("wysiwyg.common.components.verticalmenu.viewer.VerticalMenu",function(e,t,o,n,a){var r=e+"menuContainer";o.height[r]&&o.width[r]&&(a.isMobileView()?t.css(r,{height:o.height[r],width:o.width[r]}):i(o,e,t))}),{}}),define("layout/specificComponents/memberLoginSectionLayout",["lodash","layout/specificComponents/imageLayout"],function(e,t){"use strict";function i(e,t){return"true"===e[t].getAttribute("data-is-logged-in")}function o(t){var i=e.get(t,"dataItem",null);if(i){if("LoginSocialBar"===i.type)return i;if(i.loginSocialBarRef)return i.loginSocialBarRef}return null}function n(t){var i=o(t);return e.get(i,"iconItemsRef.menuRef.items",null)}function a(t){var i=o(t);return"textOnly"!==e.get(i,"loggedInMember")}function r(t){return e.get(t,"propertiesItem.iconSize",u)}function s(t){return e.get(t.getSiteMemberDetails(),"attributes.imageUrl",null)}var u=30;return{measure:function(t,o,n,a,r,s){var u=t+(s||"");o.custom[u]=e.merge(o.custom[u]||{},{dataStates:n[u].getAttribute("data-state")||"",isLoggedIn:i(n,u)})},patch:function(i,o,u,c,l,g){var d=i+(g||"");!function(e,i,o,n,u){var c=e+"avatarimage",l=r(n);if(a(n)){var g=s(u);o.width[c]&&t.patchNodeImage(c,i,o,u,{uri:g},{width:l,height:l})}}(d,o,u,c,l),function(i,o,a,s,u){if(a.custom[i].isLoggedIn){var c=n(s)||[],l=r(s);e.forEach(c,function(e,n){var r=i+"button"+n+"iconimage",s=i+"button"+n+"iconsvg";e.iconRef&&(a.width[r]?t.patchNodeImage(r,o,a,u,e.iconRef,{width:l,height:l}):a.width[s])})}}(d,o,u,c,l)},getChildrenIdToMeasure:function(t,o,r,u,c){var l=[];if(a(u)&&i(r,o)&&s(t)&&l.push({pathArray:["avatar","image"],type:"core.components.Image"}),i(r,o)){var g=n(u);e.forEach(g,function(e,t){e.iconRef&&"Image"===e.iconRef.type&&l.push({pathArray:["button"+t,"icon","image"],type:"core.components.Image"})})}return c&&e.forEach(l,function(t){e.isArray(t.pathArray)&&t.pathArray.splice(0,0,c)}),l}}}),define("layout/specificComponents/loginSocialBarLayout",["lodash","layout/util/layout","warmupUtils","zepto","layout/specificComponents/memberLoginSectionLayout"],function(e,t,i,o,n){"use strict";function a(t,n,a,r){var s=a[t].getBoundingClientRect(),u=a[t+l],c=a[t+d],g=n.custom[t].borderWidth,h=c.offsetWidth,p={top:n.height[t]-g+"px"},m=void 0;if(u.children.length>0&&h>0){var f=r.isMobileView()?o("#SITE_ROOT")[0]:o("#SITE_CONTAINER")[0],y=u.children[0].getBoundingClientRect(),w=i.domMeasurements.getBoundingRect(c.offsetParent,f),v=s.right-y.right-g,C=y.left-s.left-g,M={right:v+"px",left:"initial"},S={left:C+"px",right:"initial"};!function(t,i,o){var n,a,r=(n=o,a=t,n[a].getAttribute("data-state"));return r&&e.includes(r,"rtl")}(t,0,a)?(m=M,w.right-v-h<0&&(m=S)):(m=S,w.left+C+h>n.width.screen&&(m=M))}n.custom[t+d]=e.assign(p,m||{})}var r="buttons",s="user",u="icon",c="text",l="arrow",g="login",d="dropdownMenu";t.registerCustomMeasure("wysiwyg.viewer.components.LoginSocialBar",function(e,t,i,d,h){t.custom[e]={dataStates:i[e].getAttribute("data-state")||"",borderWidth:parseInt(o(i[e]).css("border-width"),10)||0},function(e,t,i,o,n){var a=i[e+r],s=i[e+u],d=i[e+l],h=i[e+c],p=a.offsetWidth,m=s.offsetWidth,f=d.offsetWidth,y=h.offsetWidth,w=t.custom[e].borderWidth,v=i[e+g].offsetWidth,C=y>0&&0===p&&0===m?14:0,M=Math.max(p+m+f+C,v)+2*w,S=M;y>0&&(S+=60);var I=Math.max(S,n.layout.width),b=I-M;t.minWidth[e]=S,t.width[e]=I,t.custom[e+c]=b}(e,t,i,0,h),function(e,t,i,o,n){var a=i[e+r],u=i[e+s],c=i[e+g],l=a.offsetHeight,d=u.offsetHeight,h=c.offsetHeight,p=t.custom[e].borderWidth,m=Math.max(l,d,h)+2*p,f=Math.max(m,n.layout.height);t.minHeight[e]=m,t.height[e]=f}(e,t,i,0,h),a(e,t,i,d),n.measure(e,t,i,d,h)}),t.registerPatcher("wysiwyg.viewer.components.LoginSocialBar",function(e,t,i,o,a){t.css(e,{width:i.width[e]+"px",minWidth:i.minWidth[e]+"px",minHeight:i.minHeight[e]+"px"}),t.css(e+c,{maxWidth:i.custom[e+c]+"px"}),t.css(e+d,i.custom[e+d]),n.patch(e,t,i,o,a)}),t.registerRequestToMeasureChildren("wysiwyg.viewer.components.LoginSocialBar",function(e,t,i,o){var a=[[r],[s],[u],[c],[l],[g],[d]],h=n.getChildrenIdToMeasure(o,e,t,i);return a=a.concat(h)})}),define("layout/util/spaceCalculationsRegardingWixAds",["experiment"],function(e){"use strict";function t(e){var t=parseInt(e,10);return isNaN(t)?0:t}return{getFirstUnoccupiedTopCoordinate:function(e){return t(e.height.WIX_ADStop)+t(e.top.WIX_ADStop)},getScreenHeightExcludingAds:function(i){var o=i.height.screen,n=t(i.height.WIX_ADStop)+t(i.top.WIX_ADStop);return e.isOpen("displayWixAdsNewVersion")?o-n:o-n-t(i.height.WIX_ADSbottom)}}}),define("layout/specificComponents/dialogLayout",["lodash","layout/util/layout","layout/util/spaceCalculationsRegardingWixAds"],function(e,t,i){"use strict";function o(e,t,o){var n=e+"dialog",a=o.height[n],r=o.height.screen,s=i.getFirstUnoccupiedTopCoordinate(o),u=i.getScreenHeightExcludingAds(o);t.css(e,{height:r+"px"});var c=(u-a)/2;t.css(n,{top:Math.max(c,20)+s+"px"})}e.forEach(["wysiwyg.viewer.components.dialogs.EnterPasswordDialog","wysiwyg.viewer.components.dialogs.NotificationDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.EmailVerificationDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.MemberLoginDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.NoPermissionsToPageDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.RequestPasswordResetDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.ResetPasswordDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.SentConfirmationEmailDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.SignUpDialog","wysiwyg.viewer.components.dialogs.siteMemberDialogs.WelcomeDialog"],function(e){t.registerRequestToMeasureChildren(e,[["dialog"]]),t.registerPatcher(e,o)})}),define("layout/specificComponents/siteBackgroundLayout",["lodash","zepto","layout/util/layout","warmupUtils","layout/specificComponents/html5VideoLayout","layout/util/optimizedCssImageLayout","experiment"],function(e,t,i,o,n,a,r){"use strict";function s(e,t,i){var o={availWidth:e.width.screen,availHeight:e.height.screen,pixelAspectRatio:e.devicePixelRatio};if(t&&i){var n=Math.min(e.availWidth.device,e.availHeight.device),a=Math.max(e.availWidth.device,e.availHeight.device);o.availHeight=Math.round(o.availWidth*(a/n))}return o}function u(e,t,i){return i&&e.mediaRef&&"viewport"===t}function c(t,i,o,n,a){var r={},s=e.at(v.fittingTypes,["LEGACY_BG_NORMAL","LEGACY_BG_FIT_AND_TILE","LEGACY_BG_FIT_AND_TILE_HORIZONTAL","LEGACY_BG_FIT_AND_TILE_VERTICAL"]),u=e.includes(s,i.fittingType);if(n&&!u)r.width=o.availWidth,r.height=o.availHeight,r.pixelAspectRatio=o.pixelAspectRatio;else{var c=a?h:d;r.width=Math.min(c,t.width),r.height=Math.min(c,Math.round(r.width/(t.width/t.height)))}return r.htmlTag="bg",r.alignment=i.alignType,r}function l(t,i,o){var n=t.bgData,a=n.mediaRef,r={backgroundSize:"",backgroundPosition:"",backgroundRepeat:""},l="";if(a){"WixVideo"===a.type&&(a=a.posterImageRef);var g=i.isMobileView(),d=s(o,g,i.isMobileDevice()),h=u(n,t.mediaSizing,g),p={id:a.uri,width:a.width,height:a.height},m=c(a,n,d,h,g),f=e.defaults({quality:85},a.quality||{}),y=v.getData(n.fittingType,p,m,f,i.browser);l=y.uri,r={backgroundSize:y.css.container.backgroundSize,backgroundPosition:y.css.container.backgroundPosition,backgroundRepeat:y.css.container.backgroundRepeat,height:t.currentImageHeight},h&&("fill"===n.fittingType&&(r.backgroundSize="auto 100%",r.height=d.availHeight),r.backgroundPosition=r.backgroundPosition.replace(/(center|bottom)$/,"top"))}return{css:r,uri:l}}function g(e,t,i){var o=parseInt(e.height.WIX_ADStop,10);o=isNaN(o)?0:o;var n=parseInt(e.top.WIX_ADStop,10);return n=isNaN(n)?0:n,t||r.isOpen("displayWixAdsNewVersion",i)?o:n}var d=1920,h=1e3,p="siteBackgroundcurrentImage",m="siteBackgroundcurrent",f="siteBackgroundprevious",y="bgVideo",w=y+"poster",v=o.imageClientApi;return i.registerRequestToMeasureDom("wysiwyg.viewer.components.SiteBackground"),i.registerRequestToMeasureChildren("wysiwyg.viewer.components.SiteBackground",function(e,t,i,o){return[[o.getPrimaryPageId()]]}),i.registerPatcher("wysiwyg.viewer.components.SiteBackground",function(e,t,i,o,u){i.top[e]=g(i,u.isMobileView(),u),i.width[e]=function(e,t){var i=e.width[t.getStructureCompId()];return Math.ceil(Math.max(e.width.screen,i))}(i,u),i.height[e]=function(e,t){var i=e.height[t.getStructureCompId()],o=e.height.screen-g(e,t.isMobileView(),t);return Math.max(o,i)}(i,u),i.height.currentImage=i.height.masterPage,t.css(e,{top:i.top[e]+"px",height:i.height[e]+"px",width:i.width[e]+"px"});var c=i.custom[e],d=u.isMobileView(),h=u.isMobileDevice(),w={width:d?i.width.screen:"100%",height:d&&"fixed"===c.bgPosition?s(i,d,h).availHeight:"100%"};if(t.css(m,w),t.css(f,w),!u.isMobileView()&&r.isOpen("displayWixAdsNewVersion")){var v=g(i,u.isMobileView(),u),C=window.document.querySelector("."+m).style.position,M=window.document.querySelector("."+f).style.position;"fixed"===C&&t.css(m,{top:v+"px"}),"fixed"===M&&t.css(f,{top:v+"px"})}var S=l(c,u,i);if(a.patchCssImage(c,p,t,S.css,S.uri,u),i.custom[e].hasVideo){var I={designDataItem:{background:c.bgData}},b={width:i.width.screen,height:i.height.screen};n.patchBgVideo(e+y,t,i,I,u,b.height,b)}}),i.registerCustomMeasure("wysiwyg.viewer.components.SiteBackground",function(i,o,s,c){s[p]=window.document.querySelector("."+p),s[m]=window.document.querySelector("."+m),s[f]=window.document.querySelector("."+f);var l=function(e,t){var i=void 0;i=r.isOpen("sv_preferBgDataFromPage")?e.getDataByQuery(t,t):e.getDataByQuery(t);var o=e.isMobileView()?"mobile":"desktop";return{bgData:i.pageBackgrounds[o].ref,mediaSizing:i.pageBackgrounds[o].mediaSizing}}(c,c.getPrimaryPageId());if(o.custom[i]={bgData:l.bgData,hasVideo:!1,mediaSizing:l.mediaSizing,currentImageHeight:t(s[p]).data("height")},u(l.bgData,l.mediaSizing,c.isMobileView())&&(o.custom[i].bgPosition=t(s[m]).data("position")),a.cacheCssImageMeasureData(o.custom[i],s[p]),"WixVideo"===e.get(l.bgData.mediaRef,"type")&&!c.isTouchDevice()){o.custom[i].hasVideo=!0,s[i+y]=window.document.querySelector(".siteBackgroundcurrentVideo"),s[i+w]=s[i+y].querySelector("."+w),o.custom[i+y]={bgData:l.bgData,quality:s[i+y].getAttribute("data-quality")};var g={designDataItem:{background:l.bgData}};n.measureBgVideo(i+y,o,s,c,g)}}),{testAPI:{getDeviceScreenDimensions:s,calculateTargetImageSize:c,getCssImageData:l}}}),define("layout/specificComponents/wixFreemiumBannerLayout",["lodash","layout/util/layout","experiment"],function(e,t,i){"use strict";t.registerRequestToMeasureChildren("wysiwyg.viewer.components.WixAds",[["top"],["bottom"]]),t.registerCustomMeasure("wysiwyg.viewer.components.WixAds",function(t,o,n,a){var r=a.isMobileView(),s=["height","width","top","left"],u=void 0;u=i.isOpen("displayWixAdsNewVersion")?["top"]:r?["top"]:["top","bottom"];var c=n.WIX_ADStop.getBoundingClientRect();o.height.WIX_ADStop=c.height,e.forEach(u,function(i){var a=t+i,r=n[a].getBoundingClientRect();o.custom[a]=r,e.forEach(s,function(e){o[e][a]=Math.ceil(r[e])})}),r&&(o.top.WIX_ADStop=0)}),i.isOpen("displayWixAdsNewVersion")||t.registerPatcher("wysiwyg.viewer.components.WixAds",function(e,t){t.css(e,{visibility:""})})}),define("layout/specificComponents/documentMediaLayout",["zepto","lodash","layout/util/layout","imageClientLib","layout/specificComponents/imageLayout"],function(e,t,i,o,n){"use strict";i.registerRequestToMeasureChildren("wysiwyg.viewer.components.documentmedia.DocumentMedia",[["label"],{pathArray:["img"],type:"core.components.Image"},["link"]]),i.registerCustomMeasure("wysiwyg.viewer.components.documentmedia.DocumentMedia",function(t,i,o){var n=e(o[t]),a=t+"label",r=i.width[a],s=i.height[a],u=Math.max(i.width[t],r),c=n.data("content-padding-left"),l=n.data("content-padding-right"),g=n.data("content-padding-top"),d=n.data("content-image-height"),h={width:u-c-l,height:Math.max(d-g-s,1)};i.custom[t]={containerSize:h},i.width[t]=u,i.minWidth[t]=r}),i.registerPatcher("wysiwyg.viewer.components.documentmedia.DocumentMedia",function(e,i,a,r,s){var u=t.defaults({displayMode:o.fittingTypes.LEGACY_FULL},r.dataItem);n.patchNodeImage(e+"img",i,a,s,u,a.custom[e].containerSize),i.css(e,{width:a.width[e]})})}),define("layout/util/svgLayoutUtils",["lodash","warmupUtils"],function(e,t){"use strict";var i={width:1,height:1,x:0,y:0},o=function(e){return e.x+" "+e.y+" "+e.width+" "+e.height};return{getSvgScaleProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments[1],a=arguments[2],r=arguments[3],s=r?"xMidYMid meet":"none",u=t.svgFeatureDetection.flags().isVectorEffect,c=n?function(e,t,i,o){var n=(i.width-t)/e.width,a=(i.height-t)/e.height,r=Math.min(n,a),s=i.width/(o?r:n),u=i.height/(o?r:a);return{width:s,height:u,x:e.x-(s-e.width)/2,y:e.y-(u-e.height)/2}}(e,n,a,r):e;return{viewBox:o(c),strokeWidth:n&&!u?function(e,t,i){return t*(1/Math.min((i.width-t)/e.width,(i.height-t)/e.height))}(e,n,a):n,width:a.width,height:a.height,preserveAspectRatio:s}}}}),define("layout/specificComponents/svgShape/svgScalerUtils",[],function(){"use strict";return{trim:function(e){return e.replace(/^\s+|\s+$/g,"")},round:function(e){return Math.round(1e6*e)/1e6}}}),define("layout/specificComponents/svgShape/svgPathParser",["lodash","layout/specificComponents/svgShape/svgScalerUtils"],function(e,t){"use strict";return{getParsedPath:function(i){var o=t.trim(i);return""===o?[]:o.match(/[a-z][^a-z]*/gi).map(function(i){for(i=i.replace(/-/g," -").replace(/,/g," ").replace(/(-?\d*[\.\-]\d+)/g,function(e,t){return" "+t});e.includes(i,"  ");)i=i.replace(/ {2}/g," ");return[i.substring(0,1),t.trim(i.substring(1))]}).map(function(t){var i=[];if(!e.includes("QSCL",t[0].toUpperCase())||1!==t[1].split(",").length)return t;var o=t[1].split(" ");return o.length%2!=0?t:(o.forEach(function(e,t,o){t%2==0&&i.push(e+" "+o[t+1])}),[t[0],i.join(",")])})},stringifyParsedPath:function(e){var t="";return e.forEach(function(e){e.forEach(function(e){t+=e})}),t}}}),define("layout/specificComponents/svgShape/svgBasicScaler",["layout/specificComponents/svgShape/svgScalerUtils"],function(e){"use strict";var t=function(t,i){return e.round(parseFloat(t)*i)},i=function(e,i,o){var n=e.split(/[\s,]+/);return t(n[0],i)+" "+t(n[1],o)};return{scaleSingleValue:t,scalePairString:i,scaleMultiplePairStrings:function(t,o,n){return""===t?"":t.split(",").map(function(t){return i(e.trim(t),o,n)}).join(",")},scaleMultipleSingleStrings:function(i,o){return""===i?"":i.split(/[\s,]+/).map(function(i){return t(e.trim(i),o)}).join(",")}}}),define("layout/specificComponents/svgShape/svgPathScaler",["lodash","layout/specificComponents/svgShape/svgPathParser","layout/specificComponents/svgShape/svgBasicScaler","warmupUtils"],function(e,t,i,o){"use strict";var n=function(e,t,n){if(7!==e.length)return o.log.verbose("incorrect arc string, should have exactly 7 parameters. (value was "+e.join(" ")),e.join(" ");e[0]=i.scaleSingleValue(e[0],t),e[1]=i.scaleSingleValue(e[1],n),e[2]=(a=e[2],r=t,s=n,i.scaleSingleValue(a,s/(360*r)));var a,r,s;return e[5]=i.scaleSingleValue(e[5],t),e[6]=i.scaleSingleValue(e[6],n),e.join(" ")},a={M:i.scaleMultiplePairStrings,L:i.scaleMultiplePairStrings,H:i.scaleMultipleSingleStrings,V:i.scaleMultipleSingleStrings,Z:function(){return""},C:i.scaleMultiplePairStrings,S:i.scaleMultiplePairStrings,Q:i.scaleMultiplePairStrings,T:i.scaleMultiplePairStrings,A:function(t,i,o){var a=t.split(/[\s,]+/),r=e.chunk(a,7),s=[];return e.forEach(r,function(e){s.push(n(e,i,o))}),s.join(" ")}};return{scale:function(i,o,n){var r=t.getParsedPath(i.getAttribute("d"));return e.forEach(r,function(e){var t=[e[1]],i=e[0].toUpperCase();"V"===i?t.push(n):"H"===i?t.push(o):(t.push(o),t.push(n)),e[1]=a[e[0].toUpperCase()].apply(null,t)}),{d:t.stringifyParsedPath(r)}}}}),define("layout/specificComponents/svgShape/svgPolygonParser",["layout/specificComponents/svgShape/svgScalerUtils"],function(e){"use strict";return{getParsedPoints:function(t){var i=e.trim(t),o=i.split(/[\s,]+/),n=[];if(""===i)return[];for(var a=0;a<o.length;a+=2)n.push([o[a],o[a+1]]);return n},stringifyPoints:function(t){var i="";return t.forEach(function(e){i+=e.join(",")+" "}),e.trim(i)}}}),define("layout/specificComponents/svgShape/svgPolygonScaler",["lodash","layout/specificComponents/svgShape/svgBasicScaler","layout/specificComponents/svgShape/svgPolygonParser"],function(e,t,i){"use strict";return{scale:function(o,n,a){var r=i.getParsedPoints(o.getAttribute("points"));return e.forEach(r,function(e){e[0]=t.scaleSingleValue(e[0],n),e[1]=t.scaleSingleValue(e[1],a)}),e.isEmpty(r)?{}:{points:i.stringifyPoints(r)}}}}),define("layout/specificComponents/svgShape/svgCircleScaler",["layout/specificComponents/svgShape/svgBasicScaler"],function(e){"use strict";return{scale:function(t,i,o){var n=t.getAttribute("cx"),a=t.getAttribute("cy"),r=t.getAttribute("r"),s=Math.min(i,o);return n&&a?{cx:e.scaleSingleValue(n,s),cy:e.scaleSingleValue(a,s),r:e.scaleSingleValue(r,s)}:{}}}}),define("layout/specificComponents/svgShape/svgRectScaler",["lodash","layout/specificComponents/svgShape/svgBasicScaler"],function(e,t){"use strict";function i(i,o,n){return o?e.set({},i,t.scaleSingleValue(o,n)):null}return{scale:function(t,o,n){var a=t.getAttribute("width"),r=t.getAttribute("height"),s=t.getAttribute("rx"),u=t.getAttribute("ry"),c=t.getAttribute("x"),l=t.getAttribute("y");return e.assign({},i("width",a,o),i("height",r,n),i("rx",s,o),i("ry",u,n),i("x",c,o),i("y",l,n))}}}),define("layout/specificComponents/svgShape/svgEllipseScaler",["layout/specificComponents/svgShape/svgBasicScaler"],function(e){"use strict";return{scale:function(t,i,o){var n=t.getAttribute("cx"),a=t.getAttribute("cy"),r=t.getAttribute("rx"),s=t.getAttribute("ry"),u={};return n&&r&&(u.cx=e.scaleSingleValue(n,i),u.rx=e.scaleSingleValue(r,i)),a&&s&&(u.cy=e.scaleSingleValue(a,o),u.ry=e.scaleSingleValue(s,o)),u}}}),define("layout/specificComponents/svgShape/svgPolylineParser",["lodash","layout/specificComponents/svgShape/svgScalerUtils"],function(e,t){"use strict";return{getParsedPoints:function(e){var i=t.trim(e),o=i.split(/[\s,]+/),n=[];if(""===i)return[];for(var a=0;a<o.length;a+=2)n.push([o[a],o[a+1]]);return n},stringifyPoints:function(e){var i="";return e.forEach(function(e){i+=e.join(",")+" "}),t.trim(i)}}}),define("layout/specificComponents/svgShape/svgPolylineScaler",["lodash","layout/specificComponents/svgShape/svgBasicScaler","layout/specificComponents/svgShape/svgPolylineParser"],function(e,t,i){"use strict";return{scale:function(o,n,a){var r=i.getParsedPoints(o.getAttribute("points"));return r=e.map(r,function(i){return e.map(i,function(e,i){return t.scaleSingleValue(e,i?a:n)})}),e.isEmpty(r)?{}:{points:i.stringifyPoints(r)}}}}),define("layout/specificComponents/svgShape/svgLineScaler",["layout/specificComponents/svgShape/svgBasicScaler"],function(e){"use strict";return{scale:function(t,i,o){var n=t.getAttribute("x1"),a=t.getAttribute("y1"),r=t.getAttribute("x2"),s=t.getAttribute("y2");return n&&a&&r&&s?{x1:e.scaleSingleValue(n,i),x2:e.scaleSingleValue(r,i),y1:e.scaleSingleValue(a,o),y2:e.scaleSingleValue(s,o)}:{}}}}),define("layout/specificComponents/svgShape/svgScaler",["lodash","layout/specificComponents/svgShape/svgScalerUtils","layout/specificComponents/svgShape/svgPathScaler","layout/specificComponents/svgShape/svgPolygonScaler","layout/specificComponents/svgShape/svgCircleScaler","layout/specificComponents/svgShape/svgRectScaler","layout/specificComponents/svgShape/svgEllipseScaler","layout/specificComponents/svgShape/svgPolylineScaler","layout/specificComponents/svgShape/svgLineScaler"],function(e,t,i,o,n,a,r,s,u){"use strict";var c=["path","polygon","rect","circle","ellipse","polyline","line"];return{measure:function(l,g,d,h,p,m){var f=g[l+"svg"],y=function(e){var t=window.document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}(f),w=g[l+"svg-g"]=f.getElementsByTagName("g")[0],v=e.pick(h,["width","height"]),C=e.pick(h,["x","y"]),M={path:i,polygon:o,rect:a,circle:n,ellipse:r,polyline:s,line:u};if(w){var S,I=function(e,i,o,n){var a=i.width/i.height,r=a>n,s=a<n,u=void 0,c=void 0;return u=e.width?o&&r?i.height*n/e.width:i.width/e.width:1,c=e.height?o&&s?i.width/n/e.height:i.height/e.height:1,{scaleX:t.round(u),scaleY:t.round(c)}}(v,d,m,h.width/h.height),b={scalers:{},style:{},groupTransform:{}},T=(S=y,window.document.createRange().createContextualFragment(S).querySelector("g").querySelectorAll(c.join(","))),A=void 0,L=void 0;e.forEach(T,function(e,t){A=e.nodeName.toLowerCase(),L=l+"svg"+A+t,b.scalers[L]=M[A].scale(e,I.scaleX,I.scaleY)}),e(w.childNodes).filter(function(t){return i=t.nodeName,e.includes(c,i.toLowerCase());var i}).forEach(function(e,t){A=e.nodeName.toLowerCase(),g[L=l+"svg"+A+t]=e}),b.groupTransform=(E=p,x={x:C.x*I.scaleX,y:C.y*I.scaleY},{transform:"translate("+parseFloat(-1*x.x+.5*E)+","+parseFloat(-1*x.y+.5*E)+")"});var E,x;return b.style={strokeWidth:p,width:Math.ceil(v.width*I.scaleX+p)+"px",height:Math.ceil(v.height*I.scaleY+p)+"px"},b}},patch:function(t,i,o){i.css(t+"svg",o.style),i.attr(t+"svg-g",o.groupTransform),e.forEach(o.scalers,function(e,t){i.attr(t,e)}),i.attr(t+"svg",{viewBox:" "})}}}),define("layout/specificComponents/shapeLayout",["lodash","warmupUtils","layout/util/layout","layout/util/svgLayoutUtils","layout/specificComponents/svgShape/svgScaler"],function(e,t,i,o,n){"use strict";function a(e,i,a,r){var s=e[i],u=e[i+"svg"],c=r?function(e){var t=e.split(" "),i=_slicedToArray(t,4);return{x:i[0],y:i[1],width:i[2],height:i[3]}}(r):u.getBBox();if(c){var l="stretch"!==s.getAttribute("data-display-mode"),g=parseInt(s.getAttribute("data-strokewidth"),10),d={width:s.offsetWidth,height:s.offsetHeight};return function(e,i){var o=t.svgFeatureDetection.flags().isVectorEffect;return e>0&&!i&&!o}(g,l)?(d.width-=g,d.height-=g,{polyfillScale:n.measure(i,e,d,c,g,l)}):{scale:o.getSvgScaleProps(c,g,d,l)}}}function r(t,i){var o=[],r={};return e.forEach(t,function(e){var t=e.getAttribute("id");i[t]=e,r[t]=function(e,t){if(t[e]){var i=t[e],o=i.getAttribute("data-svg-id"),n=i.querySelector("svg"),r="preserve"===i.getAttribute("data-preserve-viewbox")?i.getAttribute("data-viewbox"):"";return o&&n?(t[e+"svg"]=n,a(t,e,0,r)):void 0}}(t,i),o.push(t)}),function(t){e.forEach(o,function(i){return function(t,i,o){var a=e.get(o,"scale"),r=e.get(o,"polyfillScale");a?(i.css(t+"svg",e.pick(a,["strokeWidth"])),i.attr(t+"svg",e.pick(a,["preserveAspectRatio","viewBox"]))):r&&n.patch(t,i,r)}(i,t,r[i])})}}function s(e,t){return t[e].getAttribute("data-svg-id")?r([t[e]],t):r(t[e].querySelectorAll("*[data-svg-id]"),t)}return i.registerCustomLayoutFunction("wysiwyg.viewer.components.VectorImage",s),i.registerCustomLayoutFunction("wysiwyg.viewer.components.svgshape.SvgShape",s),i.registerCustomLayoutFunction("wysiwyg.viewer.components.PopupCloseIconButton",s),i.registerCustomLayoutFunction("wysiwyg.viewer.components.MediaControls",s),i.registerCustomLayoutFunction("wysiwyg.viewer.components.mobile.TinyMenu",s),i.registerCustomLayoutFunction("wysiwyg.viewer.components.LoginSocialBar",s),{layoutShapeNodes:s}}),define("layout/specificComponents/tinyMenuLayout",["zepto","layout/util/layout","warmupUtils","experiment","layout/util/rootLayoutUtils","lodash","layout/specificComponents/memberLoginSectionLayout"],function(e,t,i,o,n,a,r){"use strict";function s(e){return a.get(e,"dataItem.loginSocialBarRef")}function u(e,t,i){return t[e+p]&&s(i)}var c="menuContainer",l="menuButton",g="menuItems",d="menuBackground",h="fullScreenOverlay",p="tinyMenuMemberSection",m="wysiwyg.viewer.skins.mobile.TinyMenuSkin";t.registerRequestToMeasureChildren("wysiwyg.viewer.components.mobile.TinyMenu",function(e,t,i,o){var n=[[c],[l],[g],[h],[d]],a=e+p;if(t[a]=t[e].querySelector("#"+a),u(e,t,i)){n.push({pathArray:[p],type:"wysiwyg.viewer.components.mobile.TinyMenuMemberSection"});var s=r.getChildrenIdToMeasure(o,a,t,i,p);n=n.concat(s)}return n}),t.registerCustomMeasure("wysiwyg.viewer.components.mobile.TinyMenu",function(t,o,n,s,h){var m=t+c,f=e("#SITE_ROOT")[0],y=i.domMeasurements.getElementRect(n[t],f);a.set(o.custom,["SITE_HEADER","isFixedPosition"].join("."),"fixed"===e("#SITE_HEADER").css("position")),o.custom[t]={menuContainerTop:y.bottom},o.top[m]=i.domMeasurements.getBoundingRect(n[m]).top,n[t+d]&&(o.height[t+d]=i.domMeasurements.getElementRect(n[t+d]).height),o.height[t]=o.height[t+l];var w=/menuOpen/.test(n[t+l].className);if(o.custom[t].isOpen=w,w){var v=i.domMeasurements.getElementRect(n[t+g],f);o.minHeight.masterPage=Math.max(o.minHeight.masterPage||0,v.bottom),M=o,I=s,u(C=t,S=n,b=h)&&r.measure(C,M,S,I,b,p)}var C,M,S,I,b}),t.registerPatcher("wysiwyg.viewer.components.mobile.TinyMenu",function(e,t,i,u,g){var f=e+c,y=n.getRootWidth(g,i,u.rootId)-40,w=a.get(i.custom.SITE_HEADER,"isFixedPosition"),v=u.layout.fixedPosition,C=a.get(i,["height","WIX_ADStop"],0);!function(e,t,i,o,n){var a=e+p;i.custom[e].isOpen&&i.width[a]&&s(o)&&r.patch(e,t,i,o,n,p)}(e,t,i,u,g);var M=0;if(o.isOpen("sv_fixedMobileHeader")?!w&&v&&(M=C):M=v?C:0,t.css(e+l,{marginTop:M+"px"}),a.get(u,["styleItem","skin"],m)===m)t.css(f,{maxHeight:(v?i.clientHeight-C:i.height.masterPage)-a.get(i,["custom",e,"menuContainerTop"],0),width:y+"px"});else{var S=i.height[e+d]-i.top[f];t.css(f,{paddingTop:C+"px",maxHeight:S+"px"}),t.css(e+h,{height:i.height.screen+1+"px"})}})}),define("layout/specificComponents/imageZoomLayout",["lodash","zepto","layout/util/layout","layout/specificComponents/imageLayout","imageClientLib","warmupUtils"],function(e,t,i,o,n,a){"use strict";function r(e){return e.dataItem||e.structure.compData}function s(e,t){return e.getNonPageItemZoomData()||e.getDataByQuery(t)}function u(e){var t=e.getNonPageItemZoomData();return e.getExistingRootNavigationInfo(e.getFocusedRootId()).pageItemId||t&&t.id}function c(t,i,a,r,c){var l=u(c),g=!c.isMobileView()&&c.isMobileDevice()||c.isTabletDevice(),d=s(c,l),h=e.defaults({displayMode:n.fittingTypes.LEGACY_FULL},d);h.quality=e.defaults({quality:90},h.quality||{});var p=a.custom[t],m={width:p.imageContainerWidth,height:p.imageContainerHeight};if(o.patchNodeImage(t+l+"image",i,a,c,h,m),a.custom[t].hasPanel){var f=g?p.dialogBoxWidth:m.width;i.css(t+d.id+"panel",{width:f})}}function l(e,t,i,o,n){var a=i.custom[e];t.css(e+"dialogBox",{width:a.imageContainerWidth,minHeight:a.dialogBoxHeight,paddingTop:a.paddingTop}),c(e,t,i,0,n);var r=u(n);if(a.showDescription&&a.descriptionHeight>a.descriptionHeightLimit){var s=e+r+"description";t.css(s,{height:a.descriptionHeightLimit}),t.data(s,{expandable:"true"}),t.css(s,{height:a.descriptionHeightLimit}),t.css(e+r+"ellipsis",{display:""})}}function g(e,i,o,n){var a=u(n),r=s(n,a),c=!n.isMobileView()&&n.isMobileDevice()||n.isTabletDevice()?p.getNonOptimizedViewDimensions:p.getDesktopViewDimensions,l=t(o[e]),g=function(e){var t=d(e,"padding-bottom")+d(e,"padding-top");return{horizontal:d(e,"padding-right")+d(e,"padding-left"),vertical:t}}(t(o[e+"dialogBox"])),h=e+a+"panel",m={width:parseInt(l.data("width-spacer"),10),height:parseInt(l.data("height-spacer"),10)},f={isMobileDevice:n.isMobileDevice(),isTabletDevice:n.isTabletDevice(),siteWidth:n.getSiteWidth()},y={width:i.width.screen,height:i.height.screen,innerHeight:i.innerHeight.screen};i.custom[e]=c(r,f,y,m,i.height[h],g),i.custom[e].hasPanel=Boolean(o[h])}function d(e,t){return e&&t?parseInt(e.css(t),10)||0:0}function h(e,i,o,n,a){var r=u(n),c=s(n,r),l=p.getMobileViewDimensions(c,n,i);!function(e,i){var o=t(i);if("none"!==o.css("display")){var n=parseInt(o.css("line-height"),10);e.showDescription=!0,e.descriptionHeight=o.height(),e.descriptionHeightLimit=Math.floor(3*n)}}(l,o[e+r+"description"]),l.isMobileZoom=a,i.custom[e]=l}var p=a.mediaZoomCalculations,m="wysiwyg.components.imageZoom";i.registerCustomMeasure(m,function(e,t,i,o,n){var a=r(n).id;(o.isMobileView()?h:g)(e+a,t,i,o)}),i.registerPatcher(m,function(e,t,i,o,n){var a=r(o).id;(n.isMobileView()?l:c)(e+a,t,i,o,n)}),i.registerRequestToMeasureChildren(m,function(e,t,i,o){var n=r(i).id,a=u(o),s={pathArray:[n,a,"image"],type:"core.components.Image"};return o.isMobileView()?[[n],s,[n,"dialogBox"],[n,a,"description"],[n,a,"ellipsis"]]:[[n],s,[n,"dialogBox"],[n,"buttonPrev"],[n,"buttonNext"],[n,a,"panel"]]})}),define("layout/specificComponents/tpaGalleryLayout",["lodash","layout/util/layout"],function(e,t){"use strict";function i(e,t,i,o,n){a=e,(r=t).css(a,{left:0,width:"100%"}),r.css(a+"iframe",{width:"100%"});var a,r}t.registerRequestToMeasureChildren("tpa.viewer.components.StripShowcase",[["iframe"]]),t.registerPatcher("tpa.viewer.components.StripShowcase",i),t.registerRequestToMeasureChildren("tpa.viewer.components.StripSlideshow",[["iframe"]]),t.registerPatcher("tpa.viewer.components.StripSlideshow",i),t.registerRequestToMeasureChildren("tpa.viewer.components.Collage",[["iframe"]]),t.registerPatcher("tpa.viewer.components.Collage",function(e,t,i,o){o.propertiesItem.fitToScreenWidth?t.css(e+"iframe",{width:"100%"}):t.css(e+"iframe",{width:i.width[e]})})}),define("layout/specificComponents/formMixinLayout",["layout/util/layout"],function(e){"use strict";function t(e,t,i){!function(e,t){var i=t.height[e+"wrapper"];i&&(t.height[e]=i)}(e,t),t.width[e]=Math.max(t.width[e],180),t.minWidth[e]=180}["wysiwyg.viewer.components.ContactForm","wysiwyg.viewer.components.DynamicContactForm"].forEach(function(i){e.registerCustomMeasure(i,t),e.registerRequestToMeasureChildren(i,[["wrapper"]]),e.registerPatcher(i,function(e,t,i){t.attr(e,{"data-dcf-columns":(o=i.width[e],o<240?1:o<365?2:o<490?3:4)});var o})}),e.registerRequestToMeasureDom("wysiwyg.common.components.subscribeform.viewer.SubscribeForm"),e.registerRequestToMeasureChildren("wysiwyg.common.components.subscribeform.viewer.SubscribeForm",[["wrapper"]]),e.registerCustomMeasure("wysiwyg.common.components.subscribeform.viewer.SubscribeForm",function(e,t){var i=t.height[e+"wrapper"];i&&(t.height[e]=i)})}),define("layout/specificComponents/wixSiteLayout",["zepto","layout/util/layout"],function(e,t){"use strict";function i(e){return e.isTabletDevice()&&(t=e,"WixSite"===t.rendererModel.siteInfo.documentType);var t}function o(t,i){n=n||function(){var t=e("<div>").css({visibility:"hidden",width:100,overflow:"scroll"}).appendTo("body"),i=e("<div>").css({width:"100%"}).appendTo(t).width();return t.remove(),100-i}();var o=window.document.body.clientWidth,a=window.innerWidth,r=o;a>o+n&&(r=a),t.body=window.document.body,i.width.body=r}var n=void 0;t.registerCustomMeasure("mobile.core.components.MasterPage",function(e,t,n,a){i(a)&&o(n,t)}),
t.registerPatcher("mobile.core.components.MasterPage",function(e,t,o,n,a){i(a)&&(r=o,t.css("body",{width:r.width.body}));var r})}),define("layout/specificComponents/fitToContentLayout",["lodash","layout/util/layout"],function(e,t){"use strict";function i(e,t){t.css(e,{width:"",height:""})}var o=function(e,t){t.css(e,{height:""})};return t.registerPatcher("wysiwyg.viewer.components.FacebookShare",i),t.registerPatcher("wysiwyg.viewer.components.PinterestFollow",i),t.registerPatcher("wysiwyg.viewer.components.PayPalButton",i),t.registerPatcher("platform.components.AppController",i),t.registerPatcher("wysiwyg.viewer.components.inputs.RadioGroup",o),t.registerPatcher("wysiwyg.viewer.components.LoginButton",o),t.registerPatcher("wixui.Pagination",o),t.registerPatcher("wixui.Tags",o),{}}),define("layout/specificComponents/imageButtonLayout",["lodash","layout/util/layout","layout/specificComponents/imageLayout","imageClientLib"],function(e,t,i,o){"use strict";var n=["defaultImage","hoverImage","activeImage"];t.registerRequestToMeasureDom("wysiwyg.common.components.imagebutton.viewer.ImageButton"),t.registerRequestToMeasureChildren("wysiwyg.common.components.imagebutton.viewer.ImageButton",function(){var t=e.map(n,function(e){return{pathArray:[e],type:"core.components.Image"}});return t.push(["link"]),t}()),t.registerPatcher("wysiwyg.common.components.imagebutton.viewer.ImageButton",function(t,a,r,s,u){var c,l,g=(c=t,l=r,{width:l.width[c],height:l.height[c]});e.forEach(n,function(n){!function(t,n,a,r,s,u,c){var l=s.dataItem[t];if(l){var g=n+t,d=e.defaults({displayMode:o.fittingTypes.LEGACY_FULL},l);i.patchNodeImage(g,a,r,u,d,c)}}(n,t,a,r,s,u,g)});var d=t+"link";a.css(d,{width:g.width,height:g.height})})}),define("layout/specificComponents/boxSlideShowLayout",["lodash","zepto","layout/util/layout","layout/specificComponents/balataLayout"],function(e,t,i,o){"use strict";i.registerCustomMeasure("wysiwyg.viewer.components.BoxSlideShow",function(e,t){t.height[e]=Math.max(50,t.height[e]),t.minHeight[e]=50}),i.registerCustomMeasure("wysiwyg.viewer.components.BoxSlideShowSlide",function(e,i,n,a,r){i.top[e]=0,i.left[e]=0;var s=t(n[e]),u=s.data("parent-id");i.minHeight[e]=s.data("min-height"),i.height[e]=i.height[u],r.designDataItem.background&&o.measure(e,i,n,a,r)}),i.registerRequestToMeasureDom("wysiwyg.viewer.components.BoxSlideShow"),i.registerRequestToMeasureDom("wysiwyg.viewer.components.BoxSlideShowSlide"),i.registerRequestToMeasureChildren("wysiwyg.viewer.components.BoxSlideShowSlide",[["inlineContentParent"],["inlineContent"]].concat(o.BALATA_PATHS_TO_REQUEST_MEASURE)),i.registerPatcher("wysiwyg.viewer.components.BoxSlideShowSlide",function(e,t,i,n,a){n.designDataItem.background&&o.patch(e,t,i,n,a)})}),define("layout/specificComponents/mediaContainerLayout",["lodash","layout/util/layout","layout/specificComponents/balataLayout"],function(e,t,i){"use strict";function o(t,o,n,r,s){if(s.designDataItem.background){i.measure(t,o,n,r,s);var u=t+a,c=window.getComputedStyle(n[u]),l=parseInt(c.getPropertyValue("border-left-width"),10);e.isUndefined(o.borderWidth)&&(o.borderWidth={}),o.borderWidth[t]=l,o.width[t]=s.layout.width||n[t].clientWidth||o.width[t]}}function n(e,t,o,n,r){n.designDataItem.background&&(t.css(e+a,{left:-o.borderWidth[e],top:-o.borderWidth[e]}),i.patch(e,t,o,n,r))}var a="container";e.forEach(["wysiwyg.viewer.components.MediaBox","wysiwyg.viewer.components.HoverBox","wysiwyg.viewer.components.MediaPlayer","wysiwyg.viewer.components.MediaContainer"],function(e){t.registerCustomMeasure(e,o),t.registerRequestToMeasureChildren(e,i.BALATA_PATHS_TO_REQUEST_MEASURE.concat([[a]])),t.registerPatcher(e,n)})}),define("layout/util/elementQueries",["lodash"],function(e){"use strict";return function(t,i,o){var n="data-element-query-",a={};return e.forEach(o,function(o,r){var s=e.get(i,[r,t]);s&&(a[n+r]="",e.forEach(o,function(e){e.min<s&&e.max>s&&(a[n+r]&&(a[n+r]+=" "),a[n+r]+=e.name)}))}),a}}),define("layout/specificComponents/mediaControlsLayout",["lodash","layout/util/layout","layout/util/elementQueries"],function(e,t,i){"use strict";var o={width:[{min:0,max:350,name:"minimal"},{min:0,max:450,name:"small"},{min:450,max:1200,name:"normal"},{min:1200,max:1/0,name:"large"}]};t.registerPatcher("wysiwyg.viewer.components.MediaControls",function(e,t,n){t.attr(e,i(e,n,o))})}),define("layout/specificComponents/mediaOverlayControlsLayout",["lodash","layout/util/layout","layout/specificComponents/shapeLayout"],function(e,t,i){"use strict";t.registerCustomLayoutFunction("wysiwyg.viewer.components.MediaOverlayControls",function(e,t){var o=e+"catcher",n=t[e].getAttribute("data-player-id");t[o]=t[e].querySelector("#"+o);var a=-t[e].offsetTop,r=-t[e].offsetLeft,s=t[n].offsetWidth,u=t[n].offsetHeight,c=i.layoutShapeNodes(e,t);return function(e){e.css(o,{top:a,left:r,width:s,height:u}),c(e)}})}),define("layout/specificComponents/columnsLayout",["lodash","warmupUtils","layout/util/layout","layout/specificComponents/balataLayout"],function(e,t,i,o){"use strict";var n=t.mediaConsts.balataConsts,a=function(e){return"true"===e.getAttribute("data-mobile-responsive")},r="wysiwyg.viewer.components.StripColumnsContainer",s="wysiwyg.viewer.components.Column";i.registerRequestToMeasureDom(r),i.registerRequestToMeasureChildren(r,o.BALATA_PATHS_TO_REQUEST_MEASURE),i.registerCustomMeasure(r,function(i,r,s,u,c){var l=u.isMobileView();if(a(s[i]))return r.custom[i]={patchBalataOnly:!0},o.measure(i,r,s,u,c);var g=t.dataUtils.getChildrenData(c.structure,l),d=e.map(g,"id");if(l){var h=2*c.propertiesItem.rowMargin+(g.length-1)*c.propertiesItem.columnsMargin;e.forEach(d,function(e,t){h+=r.height[e],r.minHeight[e]=r.height[e];var o=t===d.length-1;r.injectedAnchors[e]=o?[{fromComp:e,distance:c.propertiesItem.rowMargin,topToTop:0,originalValue:0,type:"BOTTOM_PARENT",locked:!0,targetComponent:i}]:[{fromComp:e,distance:c.propertiesItem.columnsMargin,locked:!0,originalValue:0,targetComponent:d[t+1],topToTop:0,type:"BOTTOM_TOP"}]}),r.height[i]=h,r.height[i+n.BALATA]=h}else{var p=e(r.height).pick(d).values().max();e.forEach(d,function(e){r.top[e]=c.propertiesItem.rowMargin,r.minHeight[e]=p,r.injectedAnchors[e]=[{fromComp:e,distance:0,originalValue:0,type:"BOTTOM_PARENT",locked:!0,targetComponent:i}]}),r.height[i]=p+2*c.propertiesItem.rowMargin,r.containerHeightMargin[i]=c.propertiesItem.rowMargin,r.height[i+n.BALATA]=p+2*c.propertiesItem.rowMargin}o.measure(i,r,s,u,c)}),i.registerPatcher(r,function(t,i,n,a,r){if(e.get(n.custom,[t,"patchBalataOnly"],!1))return o.patch(t,i,n,a,r);i.css(t,{height:n.height[t],left:0}),a.propertiesItem.fullWidth&&i.css(t,{width:"100%"}),o.patch(t,i,n,a,r)}),i.registerRequestToMeasureDom(s),i.registerRequestToMeasureChildren(s,o.BALATA_PATHS_TO_REQUEST_MEASURE),i.registerLayoutInnerCompsFirst(s,function(t,i,o,n,r,s,u){if(!e.isEmpty(r.anchorsMap)&&!a(i)){var c=t.structure,l=c.id,g=o.height[l];s(c),o.minHeight[l]=0,o.height[l]=c.layout.height;var d=u(c);return r.isMobileView()&&(o.top[l]=n[l].offsetTop),g!==o.height[l]&&e.set(d,l,!0),{needsAdditionalInnerLayout:!1,needsParent:!0,changedCompsMap:e.mapValues(d,e.constant(!0))}}},e.noop),i.registerCustomMeasure(s,function(e,i,r,s,u){if(a(r[e]))return i.custom[e]={patchBalataOnly:!0},o.measure(e,i,r,s,u);var c=r[e];i.height[e]=i.minHeight[e],i.width[e]=c.offsetWidth,o.measure(e,i,r,s,u),t.layoutUtils.getLayoutMechanism(s)===t.constants.LAYOUT_MECHANISMS.ANCHORS&&(i.height[e+n.BALATA]=i.minHeight[e])}),i.registerPatcher(s,function(t,i,n,a,r){if(e.get(n.custom,[t,"patchBalataOnly"],!1))return o.patch(t,i,n,a,r);i.css(t,{height:n.height[t]}),r.isMobileView()||i.css(t,{left:"",width:"",position:"relative"}),o.patch(t,i,n,a,r)})}),define("layout/util/popupContainerDocking",["lodash","layout/specificComponents/balataLayout","layout/util/rootLayoutUtils","warmupUtils"],function(e,t,i,o){"use strict";function n(t){return e.get(t.designDataItem,"background",e.get(t.dataItem,"background"))}var a="fullWidth";return{measure:function(e,i,r,s,u){var c=u.propertiesItem,l=void 0;c.alignmentType!==a?("fullHeight"===c.alignmentType&&(i.minHeight[e]=i.innerHeight.screen,i.shrinkableContainer[e]=!0,l={top:0,left:0,width:i.width[e],height:i.innerHeight.screen}),i.left[e]=o.compAlignmentUtils.getLeft(c,i.width[e],i.width.screen,s.getSiteWidth()),t.measure(e,i,r,s,u,l)):function(e,i,o,a,r){var s=i.height[e+"inlineContent"]||0;i.left[e]=0,i.width[e]=o[e].offsetWidth,i.containerHeightMargin[e]=s?o[e].offsetHeight-s:0,n(r)&&t.measure(e,i,o,a,r)}(e,i,r,s,u)},patch:function(e,r,s,u,c){var l=u.propertiesItem,g=c.getCurrentPopupId(),d=o.compAlignmentUtils.getTop(l,s.height[e],s.innerHeight.screen),h=s.height[g]=d+s.height[e];s.top[e]=d,r.css(g,{height:h}),r.css(e,{left:s.left[e],top:d,width:s.width[e],height:s.height[e]}),l.alignmentType===a?(p=e,m=r,f=s,w=c,n(y=u)&&(m.css(p,{left:0,width:i.getRootWidth(w,f,y.rootId)}),t.patch(p,m,f,y,w))):t.patch(e,r,s,u,c);var p,m,f,y,w}}}),define("layout/specificComponents/popupContainerLayout",["lodash","layout/util/layout","layout/util/popupContainerDocking","layout/specificComponents/screenWidthLayouts/screenWidthContainerLayout","layout/specificComponents/balataLayout"],function(e,t,i,o,n){"use strict";t.registerMeasureChildrenFirst("wysiwyg.viewer.components.PopupContainer",!0),t.registerRequestToMeasureChildren("wysiwyg.viewer.components.PopupContainer",[["inlineContent"]].concat(n.BALATA_PATHS_TO_REQUEST_MEASURE)),t.registerRequestToMeasureDom("wysiwyg.viewer.components.PopupContainer"),t.registerCustomMeasure("wysiwyg.viewer.components.PopupContainer",function(e,t,n,a,r){o.measureContainer(e,t,n,a,r),i.measure(e,t,n,a,r);var s="fullWidth"===r.propertiesItem.alignmentType,u="ROOT_"+r.rootId;t.width[u]=t.width[e],t.left[u]=s?0:Math.floor(t.left[e]-a.getSiteX())}),t.registerPatcher("wysiwyg.viewer.components.PopupContainer",function(e,t,o,n,a){i.patch(e,t,o,n,a)})}),define("layout/specificComponents/rssButtonLayout",["lodash","layout/util/layout","layout/specificComponents/imageLayout"],function(e,t,i){"use strict";t.registerRequestToMeasureChildren("wysiwyg.common.components.rssbutton.viewer.RSSButton",function(t,i,o){return[{type:"core.components.Image",pathArray:[e.get(o,["dataItem","image","id"])]}]}),t.registerPatcher("wysiwyg.common.components.rssbutton.viewer.RSSButton",function(t,o,n,a,r){var s=e.get(a,"layout"),u=e.get(a,["dataItem","image"]);e.assign(u,{displayMode:"full"}),i.patchNodeImage(t+e.get(u,"id"),o,n,r,u,s)})}),define("layout/specificComponents/tpaLayout",["layout/util/layout"],function(e){"use strict";e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAWidget"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAGluedWidget"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPASection"),e.registerRequestToMeasureDom("wysiwyg.viewer.components.tpapps.TPAMultiSection")}),define("layout/specificComponents/screenWidthLayouts/stripsComponentsLayout",["lodash","warmupUtils","layout/util/rootLayoutUtils","layout/util/layout","layout/specificComponents/bgImageLayout"],function(e,t,i,o,n){"use strict";function a(t){return"Image"===e.get(t,["dataItem","type"])}var r=t.layoutUtils.stretchInCenteredContainer,s="wysiwyg.viewer.components.BgImageStrip";o.registerCustomMeasure(s,function(e,t,o,s,u){var c=function(e,t,o){var n=i.getRootWidth(t,e,o),a=Math.max(e.width.screen,n);return r(n,a)}(t,s,u.rootId),l=c.width,g=c.left;t.width[e]=l,t.left[e]=g,a(u)&&n.measureLegacyBgImageStrip(e,t,o,s,u)}),o.registerPatcher(s,function(e,t,i,o,r){if(t.css(e,{width:i.width[e]+"px",left:i.left[e]+"px"}),a(o)){var s={width:i.width[e],height:i.height[e]};n.patchLegacyBgImageStrip(e,t,i,o,r,s)}else{var u=e+"bg";t.css(u,{backgroundImage:"none"})}})}),define("layout/specificComponents/screenWidthLayouts/meshFixedHeaderAndFooter",["lodash"],function(e){"use strict";return function(t){var i=window.document,o=i.querySelector("#"+t);if(!o)return e.noop;var n=i.querySelector("#"+t+"-placeholder"),a=(o.dataset.state||"").match(/\d*fixedPosition\d*/),r=o.offsetHeight+"px";return o&&n&&a?function(){n.style.height=r}:e.noop}}),define("layout/specificComponents/screenWidthLayouts/headerLayout",["lodash","layout/specificComponents/screenWidthLayouts/meshFixedHeaderAndFooter","layout/util/layout"],function(e,t,i){"use strict";var o="wysiwyg.viewer.components.HeaderContainer";i.registerRequestToMeasureDom(o),i.registerRequestToMeasureChildren(o,[["screenWidthBackground"],["inlineContent"]]),i.registerCustomLayoutFunction(o,function(i,o,n){var a=o[i];return e.merge(n,{left:_defineProperty({},i,0),width:_defineProperty({},i,parseInt(a.dataset.siteWidth,10)),top:_defineProperty({},i,"fixed"===a.style.position?0:parseInt(a.style.top,10))}),t(i)})}),define("layout/specificComponents/screenWidthLayouts/footerLayout",["warmupUtils","layout/util/layout","layout/specificComponents/screenWidthLayouts/meshFixedHeaderAndFooter"],function(e,t,i){"use strict";var o="wysiwyg.viewer.components.FooterContainer";t.registerRequestToMeasureDom(o),t.registerRequestToMeasureChildren(o,[["screenWidthBackground"],["inlineContent"]]),t.registerCustomLayoutFunction(o,function(t,o,n){var a=o[t],r="true"===a.getAttribute("data-fixedposition"),s="true"===a.getAttribute("data-isrunninginmobile"),u=e.measurerUtils.getScreenWidth(s),c=e.measurerUtils.getSiteMarginBottom();n.left[t]=0;var l=i(t);return function(e){l(),r&&e.css(t,{left:0,top:"auto",bottom:c});var i=t+"screenWidthBackground",o={width:u};e.css(i,o)}})}),define("layout/specificComponents/screenWidthLayouts/pageLayout",["lodash","warmupUtils","layout/util/layout","layout/specificComponents/balataLayout"],function(e,t,i,o){"use strict";function n(t,i,o){var n="true"===i[t].getAttribute("data-ismobile")?"mobile":"desktop";return e.get(o.dataItem,["pageBackgrounds",n,"ref"])}var a=t.mediaConsts.balataConsts.BALATA,r="mobile.core.components.Page";i.registerRequestToMeasureDom(r),i.registerMeasureChildrenFirst(r,!0),i.registerRequestToMeasureChildren(r,function(e,t){return[["inlineContent"]].concat(_toConsumableArray("true"===t[e].getAttribute("data-ispopup")?o.BALATA_PATHS_TO_REQUEST_MEASURE:[]))}),i.registerCustomLayoutFunction(r,function(i,r,s,u,c){var l="true"===r[i].getAttribute("data-ispopup");return function(e,i,o,n,a){if("true"!==o[e].dataset.isMeshLayout){var r=i.containerHeightMargin[e]||0;i.height[e]=t.layoutUtils.getPageBottomChildEnd(i,o,n,a)+r}}(i,s,r,u,c),l&&function(t,i,r,s,u){var c=n(t,r,u);if(c){var l=e.assign({designDataItem:{background:c}},u);l.id+=a,i.height[t]=r[t].offsetHeight,o.measure(t,i,r,s,l)}}(i,s,r,u,c),function(t){if(l){var g=i+a,d=e.defaultsDeep({id:g,rootId:"masterPage",structure:{behaviors:[]},designDataItem:{background:n(i,r,c)}},c);o.patch(i,t,s,d,u)}}})}),define("layout/specificComponents/screenWidthLayouts/pagesContainerLayout",["layout/util/layout"],function(e){"use strict";var t="wysiwyg.viewer.components.PagesContainer";e.registerCustomMeasure(t,function(e,t,i){t.left[e]=0;var o=i[e];"true"===o.dataset.isMesh&&(t.height[e]=o.offsetHeight)}),e.registerRequestToMeasureChildren(t,[["screenWidthBackground"],["inlineContent"]])}),define("layout/specificComponents/screenWidthLayouts/stripSlideshowLayout",["lodash","layout/util/layout","layout/specificComponents/balataLayout"],function(e,t,i){"use strict";var o="wysiwyg.viewer.components.StripContainerSlideShow",n="wysiwyg.viewer.components.StripContainerSlideShowSlide";t.registerRequestToMeasureDom(o),t.registerRequestToMeasureChildren(o,[["background"],["inlineContentParent"],["inlineContent"],["shownOnAllSlides"],["navigationArrows"],["prevButton"],["nextButton"]]),t.registerCustomMeasure(o,function(e,t,i){t.containerHeightMargin[e]=0;var o=i[e+"navigationArrows"];t.custom[e]={offset:parseInt(o.getAttribute("data-navigation-button-margin"),10)}}),t.registerPatcher(o,function(e,t,i){var o=i.custom[e].offset;t.css(e+"prevButton",{left:o}),t.css(e+"nextButton",{right:o})}),t.registerRequestToMeasureDom(n),t.registerRequestToMeasureChildren(n,[["inlineContentParent"],["inlineContent"]].concat(_toConsumableArray(i.BALATA_PATHS_TO_REQUEST_MEASURE))),t.registerCustomMeasure(n,function(e,t,o,n,a){var r=o[e],s=r.getAttribute("data-parent-id");t.left[e]=0,t.height[e]=t.height[s],t.minHeight[e]=r.getAttribute("data-min-height"),t.width[e]=r.offsetWidth,i.measure(e,t,o,n,a)}),t.registerPatcher(n,function(e,t,o,n,a){i.patch(e,t,o,n,a)})}),define("layout/specificComponents/quickActionBarLayout",["zepto","lodash","layout/util/layout","warmupUtils"],function(e,t,i,o){"use strict";var n="actionsContainer";i.registerRequestToMeasureChildren("wysiwyg.viewer.components.QuickActionBar",[[n]]),i.registerCustomMeasure("wysiwyg.viewer.components.QuickActionBar",function(i,a,r,s,u){var c=e("#SITE_ROOT")[0],l=o.domMeasurements.getElementRect(r[i],c);a.width[i]=l.width,a.height[i]=l.height;var g=t.includes(r[i].className.split(/\s+/),u.styleItem.id+"_closed");a.width[i+"maxTextWidth"]=g?0:function(i){var o=e(i).find('div[data-quick-action="text"]');return t(o).map(function(i){var o=+t.replace(e(i).css("width"),"px","");return t.isNaN(o)?0:o}).max()}(r[i]);var d=s.mobile.isZoomed(),h=s.isMobileDevice();a.custom[i]={isZoomed:d&&h,visibility:r[i].style.visibility},g&&(a.height[i+n]=l.height,a.width[i+n]=l.width)}),i.registerPatcher("wysiwyg.viewer.components.QuickActionBar",function(e,t,i){t.css(e,{top:"",left:"",width:"",height:"","z-index":1001,visibility:i.custom[e].isZoomed?"hidden":i.custom[e].visibility,"pointer-events":i.custom[e].isZoomed?"none":""})})}),define("layout/specificComponents/quickActionBarItemLayout",["layout/util/layout"],function(e){"use strict";e.registerPatcher("wysiwyg.viewer.components.QuickActionBarItem",function(e,t){t.css(e,{top:"",left:"",width:"",height:"",position:"","z-index":""})})}),define("layout/specificComponents/touchMediaZoomLayout",["zepto","lodash","warmupUtils","layout/util/layout"],function(e,t,i,o){"use strict";var n=i.touchMediaZoomUtils;o.registerCustomMeasure("wysiwyg.viewer.components.TouchMediaZoomItem",function(i,o,n){var a=e(n[i]);if(a.data("firstrender")){o.custom[i]={imageIds:[]};var r=t.toArray(a.find("img"));t.forEach(r,function(t,a){var r=i+"_image"+a;n[r]=t,o.custom[i].imageIds.push(r),o.custom[r]={imageData:e(t).data("imgdata"),scale:e(t).data("imgscale")}});var s=a.attr("id");n[i+"imageContainer"]=a.find("#"+s+"imageContainer").get(0),n[i+"info"]=a.find("#"+s+"info").get(0)}}),o.registerRequestToMeasureChildren("wysiwyg.viewer.components.TouchMediaZoom",[{pathArray:["stage_LEFT"],type:"wysiwyg.viewer.components.TouchMediaZoomItem"},{pathArray:["stage_CENTER"],type:"wysiwyg.viewer.components.TouchMediaZoomItem"},{pathArray:["stage_RIGHT"],type:"wysiwyg.viewer.components.TouchMediaZoomItem"}]),o.registerPatcher("wysiwyg.viewer.components.TouchMediaZoom",function(e,i,o,a,r){i.css(e,{top:0,position:"absolute",width:"100%",height:"100%"}),t.forEach(["stage_LEFT","stage_CENTER","stage_RIGHT"],function(a){s=e+a,u=i,l=r,(c=o).custom[s]&&(t.forEach(c.custom[s].imageIds,function(e){var t={pixelAspectRatio:l.mobile.getDevicePixelRatio(),browser:l.getBrowser(),staticMediaUrl:l.getStaticMediaUrl(),screenSize:{width:c.width.screen,height:c.height.screen}},i=c.custom[e],o=n.getImageApiData(i.imageData,t,i.scale);u.css(e,o.css.img),u.attr(e,{src:o.uri})}),u.css(s,{width:1.4*c.width.screen}),u.css(s+"imageContainer",{width:c.width.screen}),u.css(s+"info",{width:c.width.screen}));var s,u,c,l})})}),define("layout/specificComponents/siteButtonLayout",["lodash","zepto","warmupUtils","layout/util/layout"],function(e,t,i,o){"use strict";var n=new WeakMap;o.registerCustomDomChangesFunction("wysiwyg.viewer.components.SiteButton",function(o){var a,r,s=o.getAttribute("id"),u=o.querySelector("#"+s+"label"),c=t(o),l=c.data("width"),g=c.data("height"),d=n.get(o)||{},h=d.prevWidth,p=d.prevMinWidth,m=d.prevText,f=u.offsetHeight,y=u.offsetWidth,w=u.innerHTML,v=c.data("should-use-flex"),C=window.getComputedStyle(o),M=window.getComputedStyle(u),S=(a=C,a.minHeight&&Boolean(parseInt(a.minHeight,10))?parseInt(C.minHeight,10):f),I=v?y:y+(r=M,parseInt(r.marginRight,10)+parseInt(r.marginLeft,10)),b=c.data("shouldPreventWidthMeasurement"),T=l,A=g,L=Math.max(A,S),E=T;b||(E=w!==m&&I<p&&h===p&&y>0?I:Math.max(E,I));var x,P={align:c.attr("data-align"),margin:parseInt(c.attr("data-margin"),10),text:w,label:{verticalPadding:(x=M,parseInt(x.paddingTop,10)+parseInt(x.paddingBottom,10))}},D=y+P.margin>E;if("center"!==P.align){var R=v?"margin":"margin-"+P.align;P.label[R]=D?E-y:P.margin}var B={height:L,minHeight:S};b||(B.width=E),n.set(o,{prevText:P.text,prevMinWidth:I,prevWidth:E});var H=i.constants.COMP_LAYOUT_OPTIONS.CHANGES_TYPES;return[{node:o,type:H.css,changes:B},{node:u,type:H.css,changes:function(){var t=void 0;if(v){t={};var i=P.align;return"center"!==i&&P.label.margin&&(t["margin-"+i]=P.label.margin),t}return t={"line-height":L-P.label.verticalPadding+"px"},e.reduce(["margin-left","margin-right"],function(t,i){return e.isUndefined(P.label[i])||(t[i]=P.label[i]),t},t)}()}]})}),define("layout",["lodash","layout/util/layout","layout/util/rootLayoutUtils","layout/specificComponents/balataLayout","layout/specificComponents/screenWidthLayouts/screenWidthContainerLayout","layout/util/singleCompLayout","layout/specificComponents/matrixGalleryLayout","layout/specificComponents/paginatedGridGalleryLayout","layout/specificComponents/richtextLayout","layout/specificComponents/slideShowLayout","layout/specificComponents/sliderGalleryLayout","layout/specificComponents/wPhotoLayout","layout/specificComponents/fiveGridLineLayout","layout/specificComponents/registerToMeasureOnly","layout/specificComponents/registerToPureDomMeasure","layout/specificComponents/menuLayout","layout/specificComponents/verticalMenuLayout","layout/specificComponents/loginSocialBarLayout","layout/specificComponents/dialogLayout","layout/specificComponents/siteBackgroundLayout","layout/specificComponents/wixFreemiumBannerLayout","layout/specificComponents/documentMediaLayout","layout/specificComponents/shapeLayout","layout/specificComponents/tinyMenuLayout","layout/specificComponents/imageZoomLayout","layout/specificComponents/tpaGalleryLayout","layout/specificComponents/formMixinLayout","layout/specificComponents/bgImageLayout","layout/specificComponents/wixSiteLayout","layout/specificComponents/fitToContentLayout","layout/specificComponents/imageButtonLayout","layout/specificComponents/boxSlideShowLayout","layout/specificComponents/mediaContainerLayout","layout/specificComponents/mediaControlsLayout","layout/specificComponents/mediaOverlayControlsLayout","layout/specificComponents/columnsLayout","layout/specificComponents/popupContainerLayout","layout/specificComponents/rssButtonLayout","layout/specificComponents/tpaLayout","layout/specificComponents/screenWidthLayouts/stripsComponentsLayout","layout/specificComponents/screenWidthLayouts/headerLayout","layout/specificComponents/screenWidthLayouts/footerLayout","layout/specificComponents/screenWidthLayouts/pageLayout","layout/specificComponents/screenWidthLayouts/pagesContainerLayout","layout/specificComponents/screenWidthLayouts/stripSlideshowLayout","layout/specificComponents/quickActionBarLayout","layout/specificComponents/quickActionBarItemLayout","layout/specificComponents/touchMediaZoomLayout","layout/specificComponents/siteButtonLayout"],function(e,t,i,o,n,a,r,s,u,c,l,g){"use strict";return e.assign(t,{singleCompLayout:a,rootLayoutUtils:i,specificComponents:{balataLayout:o,screenWidthContainerLayout:n,matrixGalleryLayout:r,paginatedGridGalleryLayout:s,richtextLayout:u,slideShowLayout:c,sliderGalleryLayout:l,wPhotoLayout:g}})});